{% extends "base_page.html" %}
{% load static sekizai_tags %}

{% block basecontent %}

    <form class="form-inline">
        <div class="form-group">
            <!-- СПИСОК ГОДОВ -->
            <select class="form-control" name="year"
                    data-bind="value: year, options: years, optionsValue: 'year', optionsText: 'year'"></select>
            <!-- КОНЕЦ СПИСОК ГОДОВ -->
        </div>
        <div class="form-group" >
            <!-- СПИСОК ГРУПП -->
            <select class="form-control" name="group"
                    data-bind="visible: groups().length, value: group, options: groups, optionsText: 'title'"></select>
            <!-- КОНЕЦ СПИСОК ГРУПП -->
        </div>
    </form>

    <!-- СПИСОК ДИСЦИПЛИН -->
    {% include "students/marks_discipline_list.html" %}
    <!-- КОНЕЦ СПИСОК ДИСЦИПЛИН -->

    <!-- СПИСОК СТУДЕНТОВ С ОЦЕНКАМИ -->
    <table class="table table-hover table-condensed" data-bind="visible: students">
        <thead>
        <tr>
            <th>Студент</th>
            <td></td>
        </tr>
        </thead>
        <tbody data-bind="foreach: $root.students">
        <tr>
            <td data-bind="text: (second_name + ' ' + name)" style="width:20%;"></td>

            <td></td>
        </tr>
        </tbody>
    </table>
    <!-- КОНЕЦ СПИСОК СТУДЕНТОВ С ОЦЕНКАМИ -->


    {% addtoblock "js" %}
        <script src="{% static 'js/knockout.js' %}"></script>
    {% endaddtoblock %}

    {% addtoblock "js" %}
        <script src="{% static "js/ko.modal_confirm.js" %}"></script>
    {% endaddtoblock "js" %}

    {% addtoblock "js" %}
        <script src="{% static "js/ko.marks.js" %}"></script>
    {% endaddtoblock "js" %}

    {% addtoblock "js" %}
        <script>
            ko.applyBindings(new MarksViewModel({
                csrf: "{{ csrf_token }}",
                url: {
                    years: "{% url "students.views.students.ajax.json.years" %}",
                    groups: "{% url "students.views.students.ajax.json.groups" %}",
                    students: "{% url "students.views.students.ajax.json.students" %}",
                    disciplines: "{% url "students.views.marks.disciplines.index" %}",
                    discipline_add: "{% url "students.views.marks.disciplines.add" %}",
                    discipline_remove: "{% url "students.views.marks.disciplines.remove" %}",
                    discipline_edit: "{% url "students.views.marks.disciplines.edit" %}"
                }
            }));
        </script>
    {% endaddtoblock "js" %}

{% endblock %}