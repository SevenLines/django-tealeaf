<!-- ko if: group() && (isStudentsLoading() || (students && students().length == 0)) -->
<div class="jumbotron">
    <div class="row">
        <div class="col-md-9">
            <h1 class="">Группа &laquo;<!-- ko text: group()? group().title : '' --><!-- /ko -->&raquo;</h1>

            <p>
                <!-- ko if: isStudentsLoading -->Загружаю список...<!-- /ko-->
                <!-- ko ifnot: isStudentsLoading -->Список пока не готов<!-- /ko-->
            </p>
        </div>
        <!-- ko if: isStudentsLoading -->
        <div class="col-md-3">
            <div class="pull-right loader"></div>
        </div>
        <!-- /ko -->
    </div>
</div>
<!-- /ko -->
<div class=" table-responsive">
    <!-- ko ifnot: isStudentsLoading -->
    <table class="table table-condensed table-bordered table-hover" data-bind="visible: students && students().length">
        <thead>
        <tr>
            <th style="text-align: center">
                <form class="form form-inline">
                    <form class="form-group">
                        <button class="btn btn-sm btn-default pull-left" data-bind="click: toggleStudentsSorting">
                            <span class="glyphicon glyphicon-sort"></span>
                            <!-- ko text: $root.sortMethod() ? $root.sortMethod().title : "" --><!-- /ko -->
                        </button>
                        {% if user.is_authenticated %}
                            <div class="form-group  pull-right">
                                <button class="btn btn-sm btn-success"
                                        data-bind="click: $root.saveMarks, visible: students && discipline">
                                    <i class="glyphicon glyphicon glyphicon-save"></i>
                                </button>
                            </div>
                            <div class="form-group  pull-righ">
                                <button class="btn btn-sm btn-warning"
                                        data-bind="click: $root.loadStudents, visible: students && discipline">
                                    <i class="glyphicon glyphicon glyphicon-refresh"></i>
                                </button>
                            </div>
                        {% endif %}
                    </form>
                </form>
            </th>
            <!-- ko foreach: lessons -->
            <th class="mark" data-bind="css: style">
                {% if user.is_authenticated %}
                    {% include "students/marks_modal_lesson_editor.html" %}
                {% else %}
                    <div class="btn btn-sm btn-default" rel="tooltip" data-html="true" data-toggle="tooltip"
                         data-bind="attr: { 'data-original-title': info }">
                        <!-- ko if: description -->
                        <span class="glyphicon glyphicon-pushpin"></span>
                        <!-- /ko -->
                        <!-- ko ifnot: description -->
                        <span class="" data-bind="text: day"></span>
                        <!-- /ko -->
                    </div>
                {% endif %}
            </th>
            <!-- /ko -->
            <th>
                {% if user.is_authenticated %}
                    <button class="btn btn-sm btn-primary" data-bind="visible: discipline, click: addLesson">
                        <i class="glyphicon glyphicon glyphicon-plus"></i>
                    </button>
                {% endif %}
            </th>
        </tr>
        </thead>
        <tbody data-bind="foreach: $root.students">
        <tr style="text-align: center">
            <td data-bind="text: (second_name + ' ' + name), style: color, css: style"></td>
            <!-- ko foreach: marks -->
            <td class="mark"
                data-bind="css: mark_class{% if user.is_authenticated %},click: $root.clickMark{% endif %}">
                <span class="mark-text" data-bind="text: mark_text()"></span>
            </td>
            <!-- /ko -->
            <td></td>
        </tr>
        </tbody>
        <!-- ko if: lessons().length > 0 -->
        <tfoot>
        <td></td>
        <!-- ko foreach: lessons -->
        <td class="mark" data-bind="css: style">
            <div class="btn btn-sm btn-default" rel="tooltip" data-html="true" data-toggle="tooltip"
                 data-bind="attr: { 'data-original-title': info }">
                <!-- ko if: description -->
                <span class="glyphicon glyphicon-pushpin"></span>
                <!-- /ko -->
                <!-- ko ifnot: description -->
                <span class="" data-bind="text: day"></span>
                <!-- /ko -->
            </div>
        </td>
        <!-- /ko -->
        </tfoot>
        <!-- /ko -->
    </table>
    <!-- /ko -->
</div>
{% if user.is_authenticated %}
    {% include "students/mark_selector.html" %}
{% endif %}