/*!
 * Knockout JavaScript library v3.2.0
 * (c) Steven Sanderson - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */

/* MIT license */

/*
 * qTip2 - Pretty powerful tooltips - v2.2.1
 * http://qtip2.com
 *
 * Copyright (c) 2014 
 * Released under the MIT licenses
 * http://jquery.org/license
 *
 * Date: Sun Sep 7 2014 12:09 GMT+0100+0100
 * Plugins: tips modal viewport svg imagemap ie6
 * Styles: core basic css3
 */

define("config",[],function(){define("jquery",[],function(){return jQuery}),require.config({shim:{ckeditorinlinebinding:{deps:["knockout"]},select2binding:{deps:["select2"]},select2:{deps:["jquery"]},bootstrap:{deps:["jquery"]},iconpicker:{deps:["jquery"]},qtip:{deps:["jquery"]},color:{deps:["jquery"]},pickmeup:{deps:["jquery"]}},paths:{qtip:"../../../bower_components/qtip2/jquery.qtip",knockout:"../../../bower_components/knockout/dist/knockout",prettify:"../../../bower_components/google-code-prettify/bin/prettify.min","jquery.cookie":"../../../bower_components/jquery.cookie/jquery.cookie",select2:"../../../bower_components/select2/select2","jquery-impromptu":"../../../bower_components/jquery-impromptu/dist/jquery-impromptu",pickmeup:"../../../bower_components/pickmeup/js/jquery.pickmeup",iconpicker:"../../../bower_components/fontawesome-iconpicker/dist/js/fontawesome-iconpicker",color:"../../../lib/color",bootstrap:"../../../lib/bootstrap/bootstrap.min",marks:"./marks",labs:"./labs",helpers:"../../helpers","interface":"../../interface",common:"../../common","jquery.toc":"../../jquery.toc",ckeditorinlinebinding:"../../bindings/ckeditorinlinebinding",select2binding:"../../bindings/select2binding"}})}),function(){(function(p){var s=this||(0,eval)("this"),v=s.document,L=s.navigator,w=s.jQuery,D=s.JSON;(function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(module.exports||exports,require):"function"==typeof define&&define.amd?define("knockout",["exports","require"],e):e(s.ko={})})(function(e,t){function n(e,t){return null===e||typeof e in a?e===t:!1}function r(e,t){var n;return function(){n||(n=setTimeout(function(){n=p,e()},t))}}function i(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function o(e,t,n,r){u.d[e]={init:function(e,i,s,o,a){var f,l;return u.s(function(){var s=u.a.c(i()),o=!n!=!s,c=!l;if(c||t||o!==f)c&&u.Y.la()&&(l=u.a.ia(u.f.childNodes(e),!0)),o?(c||u.f.T(e,u.a.ia(l)),u.Ca(r?r(a,s):a,e)):u.f.ja(e),f=o},null,{o:e}),{controlsDescendantBindings:!0}}},u.h.ha[e]=!1,u.f.Q[e]=!0}var u="undefined"!=typeof e?e:{};u.b=function(e,t){for(var n=e.split("."),r=u,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t},u.A=function(e,t,n){e[t]=n},u.version="3.2.0",u.b("version",u.version),u.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}var r={__proto__:[]}instanceof Array,i={},o={};i[L&&/Firefox\/2/i.test(L.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],i.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(i,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)o[t[n]]=e});var a={propertychange:!0},f=v&&function(){for(var e=3,t=v.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0];);return 4<e?e:p}();return{vb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],u:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},m:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},qb:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},ua:function(e,t){var n=u.a.m(e,t);0<n?e.splice(n,1):0===n&&e.shift()},rb:function(e){e=e||[];for(var t=[],n=0,r=e.length;n<r;n++)0>u.a.m(t,e[n])&&t.push(e[n]);return t},Da:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;r<i;r++)n.push(t(e[r],r));return n},ta:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},ga:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},ea:function(e,t,n){var r=u.a.m(u.a.Xa(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},xa:r,extend:t,za:n,Aa:r?n:t,G:e,na:function(e,t){if(!e)return e;var n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r,e));return n},Ka:function(e){for(;e.firstChild;)u.removeNode(e.firstChild)},oc:function(e){e=u.a.S(e);for(var t=v.createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(u.R(e[n]));return t},ia:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++){var s=e[n].cloneNode(!0);i.push(t?u.R(s):s)}return i},T:function(e,t){u.a.Ka(e);if(t)for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])},Lb:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,s=0,o=t.length;s<o;s++)i.insertBefore(t[s],r);s=0;for(o=n.length;s<o;s++)u.removeNode(n[s])}},ka:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.shift();if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)if(e.push(n),n=n.nextSibling,!n)return;e.push(r)}}return e},Nb:function(e,t){7>f?e.setAttribute("selected",t):e.selected=t},cb:function(e){return null===e||e===p?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},vc:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},cc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(e)&16);for(;e&&e!=t;)e=e.parentNode;return!!e},Ja:function(e){return u.a.cc(e,e.ownerDocument.documentElement)},ob:function(e){return!!u.a.qb(e,u.a.Ja)},t:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},n:function(e,t,n){var r=f&&a[t];if(!r&&w)w(e).bind(t,n);else if(r||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){n.call(e,t)},s="on"+t;e.attachEvent(s,i),u.a.w.da(e,function(){e.detachEvent(s,i)})}else e.addEventListener(t,n,!1)},oa:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;"input"===u.a.t(e)&&e.type&&"click"==t.toLowerCase()?(n=e.type,n="checkbox"==n||"radio"==n):n=!1;if(w&&!n)w(e).trigger(t);else if("function"==typeof v.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");n=v.createEvent(o[t]||"HTMLEvents"),n.initEvent(t,!0,!0,s,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},c:function(e){return u.C(e)?e():e},Xa:function(e){return u.C(e)?e.v():e},Ba:function(e,t,n){if(t){var r=/\S+/g,i=e.className.match(r)||[];u.a.u(t.match(r),function(e){u.a.ea(i,e,n)}),e.className=i.join(" ")}},bb:function(e,t){var n=u.a.c(t);if(null===n||n===p)n="";var r=u.f.firstChild(e);!r||3!=r.nodeType||u.f.nextSibling(r)?u.f.T(e,[e.ownerDocument.createTextNode(n)]):r.data=n,u.a.fc(e)},Mb:function(e,t){e.name=t;if(7>=f)try{e.mergeAttributes(v.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},fc:function(e){9<=f&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},dc:function(e){if(f){var t=e.style.width;e.style.width=0,e.style.width=t}},sc:function(e,t){e=u.a.c(e),t=u.a.c(t);for(var n=[],r=e;r<=t;r++)n.push(r);return n},S:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t},yc:6===f,zc:7===f,L:f,xb:function(e,t){for(var n=u.a.S(e.getElementsByTagName("input")).concat(u.a.S(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],s=n.length-1;0<=s;s--)r(n[s])&&i.push(n[s]);return i},pc:function(e){return"string"==typeof e&&(e=u.a.cb(e))?D&&D.parse?D.parse(e):(new Function("return "+e))():null},eb:function(e,t,n){if(!D||!D.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return D.stringify(u.a.c(e),t,n)},qc:function(t,n,r){r=r||{};var i=r.params||{},s=r.includeFields||this.vb,o=t;if("object"==typeof t&&"form"===u.a.t(t))for(var o=t.action,a=s.length-1;0<=a;a--)for(var f=u.a.xb(t,s[a]),l=f.length-1;0<=l;l--)i[f[l].name]=f[l].value;n=u.a.c(n);var c=v.createElement("form");c.style.display="none",c.action=o,c.method="post";for(var h in n)t=v.createElement("input"),t.type="hidden",t.name=h,t.value=u.a.eb(u.a.c(n[h])),c.appendChild(t);e(i,function(e,t){var n=v.createElement("input");n.type="hidden",n.name=e,n.value=t,c.appendChild(n)}),v.body.appendChild(c),r.submitter?r.submitter(c):c.submit(),setTimeout(function(){c.parentNode.removeChild(c)},0)}}}(),u.b("utils",u.a),u.b("utils.arrayForEach",u.a.u),u.b("utils.arrayFirst",u.a.qb),u.b("utils.arrayFilter",u.a.ta),u.b("utils.arrayGetDistinctValues",u.a.rb),u.b("utils.arrayIndexOf",u.a.m),u.b("utils.arrayMap",u.a.Da),u.b("utils.arrayPushAll",u.a.ga),u.b("utils.arrayRemoveItem",u.a.ua),u.b("utils.extend",u.a.extend),u.b("utils.fieldsIncludedWithJsonPost",u.a.vb),u.b("utils.getFormFields",u.a.xb),u.b("utils.peekObservable",u.a.Xa),u.b("utils.postJson",u.a.qc),u.b("utils.parseJson",u.a.pc),u.b("utils.registerEventHandler",u.a.n),u.b("utils.stringifyJson",u.a.eb),u.b("utils.range",u.a.sc),u.b("utils.toggleDomNodeCssClass",u.a.Ba),u.b("utils.triggerEvent",u.a.oa),u.b("utils.unwrapObservable",u.a.c),u.b("utils.objectForEach",u.a.G),u.b("utils.addOrRemoveItem",u.a.ea),u.b("unwrap",u.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments);return e=n.shift(),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),u.a.e=new function(){function e(e,i){var s=e[n];if(!s||"null"===s||!r[s]){if(!i)return p;s=e[n]="ko"+t++,r[s]={}}return r[s]}var t=0,n="__ko__"+(new Date).getTime(),r={};return{get:function(t,n){var r=e(t,!1);return r===p?p:r[n]},set:function(t,n,r){if(r!==p||e(t,!1)!==p)e(t,!0)[n]=r},clear:function(e){var t=e[n];return t?(delete r[t],e[n]=null,!0):!1},F:function(){return t++ +n}}},u.b("utils.domData",u.a.e),u.b("utils.domData.clear",u.a.e.clear),u.a.w=new function(){function e(e,t){var r=u.a.e.get(e,n);return r===p&&t&&(r=[],u.a.e.set(e,n,r)),r}function t(n){var r=e(n,!1);if(r)for(var r=r.slice(0),s=0;s<r.length;s++)r[s](n);u.a.e.clear(n),u.a.w.cleanExternalData(n);if(i[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&t(n)}var n=u.a.e.F(),r={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{da:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},Kb:function(t,r){var i=e(t,!1);i&&(u.a.ua(i,r),0==i.length&&u.a.e.set(t,n,p))},R:function(e){if(r[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];u.a.ga(n,e.getElementsByTagName("*"));for(var s=0,o=n.length;s<o;s++)t(n[s])}return e},removeNode:function(e){u.R(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){w&&"function"==typeof w.cleanData&&w.cleanData([e])}}},u.R=u.a.w.R,u.removeNode=u.a.w.removeNode,u.b("cleanNode",u.R),u.b("removeNode",u.removeNode),u.b("utils.domNodeDisposal",u.a.w),u.b("utils.domNodeDisposal.addDisposeCallback",u.a.w.da),u.b("utils.domNodeDisposal.removeDisposeCallback",u.a.w.Kb),function(){u.a.ba=function(e){var t;if(w){if(w.parseHTML)t=w.parseHTML(e)||[];else if((t=w.clean([e]))&&t[0]){for(e=t[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var n=u.a.cb(e).toLowerCase();t=v.createElement("div"),n=n.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!n.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!n.indexOf("<td")||!n.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],e="ignored<div>"+n[1]+e+n[2]+"</div>";for("function"==typeof s.innerShiv?t.appendChild(s.innerShiv(e)):t.innerHTML=e;n[0]--;)t=t.lastChild;t=u.a.S(t.lastChild.childNodes)}return t},u.a.$a=function(e,t){u.a.Ka(e),t=u.a.c(t);if(null!==t&&t!==p)if("string"!=typeof t&&(t=t.toString()),w)w(e).html(t);else for(var n=u.a.ba(t),r=0;r<n.length;r++)e.appendChild(n[r])}}(),u.b("utils.parseHtmlFragment",u.a.ba),u.b("utils.setHtml",u.a.$a),u.D=function(){function e(t,n){if(t)if(8==t.nodeType){var r=u.D.Gb(t.nodeValue);null!=r&&n.push({bc:t,mc:r})}else if(1==t.nodeType)for(var r=0,i=t.childNodes,s=i.length;r<s;r++)e(i[r],n)}var t={};return{Ua:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[n]=e,"<!--[ko_memo:"+n+"]-->"},Rb:function(e,n){var r=t[e];if(r===p)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete t[e]}},Sb:function(t,n){var r=[];e(t,r);for(var i=0,s=r.length;i<s;i++){var o=r[i].bc,a=[o];n&&u.a.ga(a,n),u.D.Rb(r[i].mc,a),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},Gb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),u.b("memoization",u.D),u.b("memoization.memoize",u.D.Ua),u.b("memoization.unmemoize",u.D.Rb),u.b("memoization.parseMemoText",u.D.Gb),u.b("memoization.unmemoizeDomNodeAndDescendants",u.D.Sb),u.La={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return u.j({read:e,write:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,s,o;"number"==typeof t?n=t:(n=t.timeout,s=t.method),o="notifyWhenChangesStop"==s?i:r,e.Ta(function(e){return o(e,n)})},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var a={"undefined":1,"boolean":1,number:1,string:1};u.b("extenders",u.La),u.Pb=function(e,t,n){this.target=e,this.wa=t,this.ac=n,this.Cb=!1,u.A(this,"dispose",this.K)},u.Pb.prototype.K=function(){this.Cb=!0,this.ac()},u.P=function(){u.a.Aa(this,u.P.fn),this.M={}};var f="change",l={U:function(e,t,n){var r=this;n=n||f;var i=new u.Pb(r,t?e.bind(t):e,function(){u.a.ua(r.M[n],i),r.nb&&r.nb()});return r.va&&r.va(n),r.M[n]||(r.M[n]=[]),r.M[n].push(i),i},notifySubscribers:function(e,t){t=t||f;if(this.Ab(t))try{u.k.Ea();for(var n=this.M[t].slice(0),r=0,i;i=n[r];++r)i.Cb||i.wa(e)}finally{u.k.end()}},Ta:function(e){var t=this,n=u.C(t),r,i,s;t.qa||(t.qa=t.notifySubscribers,t.notifySubscribers=function(e,n){n&&n!==f?"beforeChange"===n?t.kb(e):t.qa(e,n):t.lb(e)});var o=e(function(){n&&s===t&&(s=t()),r=!1,t.Pa(i,s)&&t.qa(i=s)});t.lb=function(e){r=!0,s=e,o()},t.kb=function(e){r||(i=e,t.qa(e,"beforeChange"))}},Ab:function(e){return this.M[e]&&this.M[e].length},yb:function(){var e=0;return u.a.G(this.M,function(t,n){e+=n.length}),e},Pa:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&u.a.G(e,function(e,n){var r=u.La[e];"function"==typeof r&&(t=r(t,n)||t)}),t}};u.A(l,"subscribe",l.U),u.A(l,"extend",l.extend),u.A(l,"getSubscriptionsCount",l.yb),u.a.xa&&u.a.za(l,Function.prototype),u.P.fn=l,u.Db=function(e){return null!=e&&"function"==typeof e.U&&"function"==typeof e.notifySubscribers},u.b("subscribable",u.P),u.b("isSubscribable",u.Db),u.Y=u.k=function(){function e(e){n.push(r),r=e}function t(){r=n.pop()}var n=[],r,i=0;return{Ea:e,end:t,Jb:function(e){if(r){if(!u.Db(e))throw Error("Only subscribable things can act as dependencies");r.wa(e,e.Vb||(e.Vb=++i))}},B:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},la:function(){if(r)return r.s.la()},ma:function(){if(r)return r.ma}}}(),u.b("computedContext",u.Y),u.b("computedContext.getDependenciesCount",u.Y.la),u.b("computedContext.isInitial",u.Y.ma),u.b("computedContext.isSleeping",u.Y.Ac),u.p=function(e){function t(){return 0<arguments.length?(t.Pa(n,arguments[0])&&(t.X(),n=arguments[0],t.W()),this):(u.k.Jb(t),n)}var n=e;return u.P.call(t),u.a.Aa(t,u.p.fn),t.v=function(){return n},t.W=function(){t.notifySubscribers(n)},t.X=function(){t.notifySubscribers(n,"beforeChange")},u.A(t,"peek",t.v),u.A(t,"valueHasMutated",t.W),u.A(t,"valueWillMutate",t.X),t},u.p.fn={equalityComparer:n};var c=u.p.rc="__ko_proto__";u.p.fn[c]=u.p,u.a.xa&&u.a.za(u.p.fn,u.P.fn),u.Ma=function(e,t){return null===e||e===p||e[c]===p?!1:e[c]===t?!0:u.Ma(e[c],t)},u.C=function(e){return u.Ma(e,u.p)},u.Ra=function(e){return"function"==typeof e&&e[c]===u.p||"function"==typeof e&&e[c]===u.j&&e.hc?!0:!1},u.b("observable",u.p),u.b("isObservable",u.C),u.b("isWriteableObservable",u.Ra),u.b("isWritableObservable",u.Ra),u.aa=function(e){e=e||[];if("object"==typeof e&&"length"in e)return e=u.p(e),u.a.Aa(e,u.aa.fn),e.extend({trackArrayChanges:!0});throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")},u.aa.fn={remove:function(e){for(var t=this.v(),n=[],r="function"!=typeof e||u.C(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var s=t[i];r(s)&&(0===n.length&&this.X(),n.push(s),t.splice(i,1),i--)}return n.length&&this.W(),n},removeAll:function(e){if(e===p){var t=this.v(),n=t.slice(0);return this.X(),t.splice(0,t.length),this.W(),n}return e?this.remove(function(t){return 0<=u.a.m(e,t)}):[]},destroy:function(e){var t=this.v(),n="function"!=typeof e||u.C(e)?function(t){return t===e}:e;this.X();for(var r=t.length-1;0<=r;r--)n(t[r])&&(t[r]._destroy=!0);this.W()},destroyAll:function(e){return e===p?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=u.a.m(e,t)}):[]},indexOf:function(e){var t=this();return u.a.m(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.X(),this.v()[n]=t,this.W())}},u.a.u("pop push reverse shift sort splice unshift".split(" "),function(e){u.aa.fn[e]=function(){var t=this.v();return this.X(),this.sb(t,e,arguments),t=t[e].apply(t,arguments),this.W(),t}}),u.a.u(["slice"],function(e){u.aa.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),u.a.xa&&u.a.za(u.aa.fn,u.p.fn),u.b("observableArray",u.aa);var h="arrayChange";u.La.trackArrayChanges=function(e){function t(){if(!n){n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==f||++i,t.apply(this,arguments)};var s=[].concat(e.v()||[]);r=null,e.U(function(t){t=[].concat(t||[]);if(e.Ab(h)){var n;if(!r||1<i)r=u.a.Fa(s,t,{sparse:!0});n=r,n.length&&e.notifySubscribers(n,h)}s=t,r=null,i=0})}}if(!e.sb){var n=!1,r=null,i=0,s=e.U;e.U=e.subscribe=function(e,n,r){return r===h&&t(),s.apply(this,arguments)},e.sb=function(e,t,s){function o(e,t,n){return a[a.length]={status:e,value:t,index:n}}if(n&&!i){var a=[],f=e.length,l=s.length,c=0;switch(t){case"push":c=f;case"unshift":for(t=0;t<l;t++)o("added",s[t],c+t);break;case"pop":c=f-1;case"shift":f&&o("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>s[0]?f+s[0]:s[0]),f);for(var f=1===l?f:Math.min(t+(s[1]||0),f),l=t+l-2,c=Math.max(f,l),h=[],p=[],d=2;t<c;++t,++d)t<f&&p.push(o("deleted",e[t],t)),t<l&&h.push(o("added",s[d],t));u.a.wb(p,h);break;default:return}r=a}}}},u.s=u.j=function(e,t,n){function r(){u.a.G(N,function(e,t){t.K()}),N={}}function i(){r(),C=0,m=!0,h=!1}function s(){var e=a.throttleEvaluation;e&&0<=e?(clearTimeout(k),k=setTimeout(o,e)):a.ib?a.ib():o()}function o(e){if(d){if(y)throw Error("A 'pure' computed must not be called recursively")}else if(!m){if(x&&x()){if(!v){T();return}}else v=!1;d=!0;if(b)try{var n={};u.k.Ea({wa:function(e,t){n[t]||(n[t]=1,++C)},s:a,ma:p}),C=0,c=g.call(t)}finally{u.k.end(),d=!1}else try{var r=N,i=C;u.k.Ea({wa:function(e,t){m||(i&&r[t]?(N[t]=r[t],++C,delete r[t],--i):N[t]||(N[t]=e.U(s),++C))},s:a,ma:y?p:!C}),N={},C=0;try{var o=t?g.call(t):g()}finally{u.k.end(),i&&u.a.G(r,function(e,t){t.K()}),h=!1}a.Pa(c,o)&&(a.notifySubscribers(c,"beforeChange"),c=o,!0!==e&&a.notifySubscribers(c))}finally{d=!1}C||T()}}function a(){if(0<arguments.length){if("function"!=typeof w)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return w.apply(t,arguments),this}return u.k.Jb(a),h&&o(!0),c}function f(){return h&&!C&&o(!0),c}function l(){return h||0<C}var c,h=!0,d=!1,v=!1,m=!1,g=e,y=!1,b=!1;g&&"object"==typeof g?(n=g,g=n.read):(n=n||{},g||(g=n.read));if("function"!=typeof g)throw Error("Pass a function that returns the value of the ko.computed");var w=n.write,E=n.disposeWhenNodeIsRemoved||n.o||null,S=n.disposeWhen||n.Ia,x=S,T=i,N={},C=0,k=null;t||(t=n.owner),u.P.call(a),u.a.Aa(a,u.j.fn),a.v=f,a.la=function(){return C},a.hc="function"==typeof n.write,a.K=function(){T()},a.Z=l;var L=a.Ta;return a.Ta=function(e){L.call(a,e),a.ib=function(){a.kb(c),h=!0,a.lb(a)}},n.pure?(b=y=!0,a.va=function(){b&&(b=!1,o(!0))},a.nb=function(){a.yb()||(r(),b=h=!0)}):n.deferEvaluation&&(a.va=function(){f(),delete a.va}),u.A(a,"peek",a.v),u.A(a,"dispose",a.K),u.A(a,"isActive",a.Z),u.A(a,"getDependenciesCount",a.la),E&&(v=!0,E.nodeType&&(x=function(){return!u.a.Ja(E)||S&&S()})),b||n.deferEvaluation||o(),E&&l()&&E.nodeType&&(T=function(){u.a.w.Kb(E,T),i()},u.a.w.da(E,T)),a},u.jc=function(e){return u.Ma(e,u.j)},l=u.p.rc,u.j[l]=u.p,u.j.fn={equalityComparer:n},u.j.fn[l]=u.j,u.a.xa&&u.a.za(u.j.fn,u.P.fn),u.b("dependentObservable",u.j),u.b("computed",u.j),u.b("isComputed",u.jc),u.Ib=function(e,t){return"function"==typeof e?u.s(e,t,{pure:!0}):(e=u.a.extend({},e),e.pure=!0,u.s(e,t))},u.b("pureComputed",u.Ib),function(){function e(r,i,s){s=s||new n,r=i(r);if("object"!=typeof r||null===r||r===p||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean)return r;var o=r instanceof Array?[]:{};return s.save(r,o),t(r,function(t){var n=i(r[t]);switch(typeof n){case"boolean":case"number":case"string":case"function":o[t]=n;break;case"object":case"undefined":var u=s.get(n);o[t]=u!==p?u:e(n,i,s)}}),o}function t(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}function n(){this.keys=[],this.hb=[]}u.Qb=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;u.C(e)&&10>t;t++)e=e();return e})},u.toJSON=function(e,t,n){return e=u.Qb(e),u.a.eb(e,t,n)},n.prototype={save:function(e,t){var n=u.a.m(this.keys,e);0<=n?this.hb[n]=t:(this.keys.push(e),this.hb.push(t))},get:function(e){return e=u.a.m(this.keys,e),0<=e?this.hb[e]:p}}}(),u.b("toJS",u.Qb),u.b("toJSON",u.toJSON),function(){u.i={q:function(e){switch(u.a.t(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?u.a.e.get(e,u.d.options.Va):7>=u.a.L?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?u.i.q(e.options[e.selectedIndex]):p;default:return e.value}},ca:function(e,t,n){switch(u.a.t(e)){case"option":switch(typeof t){case"string":u.a.e.set(e,u.d.options.Va,p),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:u.a.e.set(e,u.d.options.Va,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":if(""===t||null===t)t=p;for(var r=-1,i=0,s=e.options.length,o;i<s;++i)if(o=u.i.q(e.options[i]),o==t||""==o&&t===p){r=i;break}if(n||0<=r||t===p&&1<e.size)e.selectedIndex=r;break;default:if(null===t||t===p)t="";e.value=t}}}}(),u.b("selectExtensions",u.i),u.b("selectExtensions.readValue",u.i.q),u.b("selectExtensions.writeValue",u.i.ca),u.h=function(){function e(e){e=u.a.cb(e),123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t=[],n=e.match(r),o,a,f=0;if(n){n.push(",");for(var l=0,c;c=n[l];++l){var h=c.charCodeAt(0);if(44===h){if(0>=f){o&&t.push(a?{key:o,value:a.join("")}:{unknown:o}),o=a=f=0;continue}}else if(58===h){if(!a)continue}else if(47===h&&l&&1<c.length)(h=n[l-1].match(i))&&!s[h[0]]&&(e=e.substr(e.indexOf(c)+1),n=e.match(r),n.push(","),l=-1,c="/");else if(40===h||123===h||91===h)++f;else if(41===h||125===h||93===h)--f;else if(!o&&!a){o=34===h||39===h?c.slice(1,-1):c;continue}a?a.push(c):a=[c]}}return t}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,s={"in":1,"return":1,"typeof":1},o={};return{ha:[],V:o,Wa:e,ya:function(r,i){function s(e,r){var i;if(!c){var h=u.getBindingHandler(e);if(h&&h.preprocess&&!(r=h.preprocess(r,e,s)))return;if(h=o[e])i=r,0<=u.a.m(t,i)?i=!1:(h=i.match(n),i=null===h?!1:h[1]?"Object("+h[1]+")"+h[2]:i),h=i;h&&f.push("'"+e+"':function(_z){"+i+"=_z}")}l&&(r="function(){return "+r+" }"),a.push("'"+e+"':"+r)}i=i||{};var a=[],f=[],l=i.valueAccessors,c=i.bindingParams,h="string"==typeof r?e(r):r;return u.a.u(h,function(e){s(e.key||e.unknown,e.value)}),f.length&&s("_ko_property_writers","{"+f.join(",")+" }"),a.join(",")},lc:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},pa:function(e,t,n,r,i){e&&u.C(e)?!u.Ra(e)||i&&e.v()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}}(),u.b("expressionRewriting",u.h),u.b("expressionRewriting.bindingRewriteValidators",u.h.ha),u.b("expressionRewriting.parseObjectLiteral",u.h.Wa),u.b("expressionRewriting.preProcessBindings",u.h.ya),u.b("expressionRewriting._twoWayBindings",u.h.V),u.b("jsonExpressionRewriting",u.h),u.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",u.h.ya),function(){function e(e){return 8==e.nodeType&&s.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,r){for(var i=n,s=1,o=[];i=i.nextSibling;){if(t(i)&&(s--,0===s))return o;o.push(i),e(i)&&s++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var r=n(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var i=v&&"<!--test-->"===v.createComment("test").text,s=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,a={ul:!0,ol:!0};u.f={Q:{},childNodes:function(t){return e(t)?n(t):t.childNodes},ja:function(t){if(e(t)){t=u.f.childNodes(t);for(var n=0,r=t.length;n<r;n++)u.removeNode(t[n])}else u.a.Ka(t)},T:function(t,n){if(e(t)){u.f.ja(t);for(var r=t.nextSibling,i=0,s=n.length;i<s;i++)r.parentNode.insertBefore(n[i],r)}else u.a.T(t,n)},Hb:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},Bb:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):u.f.Hb(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},gc:e,xc:function(e){return(e=(i?e.text:e.nodeValue).match(s))?e[1]:null},Fb:function(n){if(a[u.a.t(n)]){var i=n.firstChild;if(i)do if(1===i.nodeType){var s;s=i.firstChild;var o=null;if(s)do if(o)o.push(s);else if(e(s)){var f=r(s,!0);f?s=f:o=[s]}else t(s)&&(o=[s]);while(s=s.nextSibling);if(s=o)for(o=i.nextSibling,f=0;f<s.length;f++)o?n.insertBefore(s[f],o):n.appendChild(s[f])}while(i=i.nextSibling)}}}}(),u.b("virtualElements",u.f),u.b("virtualElements.allowedBindings",u.f.Q),u.b("virtualElements.emptyNode",u.f.ja),u.b("virtualElements.insertAfter",u.f.Bb),u.b("virtualElements.prepend",u.f.Hb),u.b("virtualElements.setDomNodeChildren",u.f.T),function(){u.J=function(){this.Yb={}},u.a.extend(u.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||u.g.getComponentNameForNode(e);case 8:return u.f.gc(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t),n=n?this.parseBindingsString(n,t,e):null;return u.g.mb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t),n=n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return u.g.mb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return u.f.xc(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i=this.Yb,s=e+(r&&r.valueAccessors||""),o;if(!(o=i[s])){var a,f="with($context){with($data||{}){return{"+u.h.ya(e,r)+"}}}";a=new Function("$context","$element",f),o=i[s]=a}return o(t,n)}catch(l){throw l.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+l.message,l}}}),u.J.instance=new u.J}(),u.b("bindingProvider",u.J),function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return u.a.na(u.k.B(e),function(t,n){return function(){return e()[n]}})}function r(e,t){return n(this.getBindings.bind(this,e,t))}function i(e,t,n){var r,i=u.f.firstChild(t),s=u.J.instance,a=s.preprocessNode;if(a){for(;r=i;)i=u.f.nextSibling(r),a.call(s,r);i=u.f.firstChild(t)}for(;r=i;)i=u.f.nextSibling(r),o(e,r,n)}function o(e,t,n){var r=!0,s=1===t.nodeType;s&&u.f.Fb(t);if(s&&n||u.J.instance.nodeHasBindings(t))r=f(t,null,e,n).shouldBindDescendants;r&&!c[u.a.t(t)]&&i(e,t,!s)}function a(e){var t=[],n={},r=[];return u.a.G(e,function i(s){if(!n[s]){var o=u.getBindingHandler(s);o&&(o.after&&(r.push(s),u.a.u(o.after,function(t){if(e[t]){if(-1!==u.a.m(r,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));i(t)}}),r.length--),t.push({key:s,zb:o})),n[s]=!0}}),t}function f(e,n,i,s){var o=u.a.e.get(e,h);if(!n){if(o)throw Error("You cannot apply bindings multiple times to the same element.");u.a.e.set(e,h,!0)}!o&&s&&u.Ob(e,i);var f;if(n&&"function"!=typeof n)f=n;else{var l=u.J.instance,c=l.getBindingAccessors||r,d=u.j(function(){return(f=n?n(i,e):c.call(l,e,i))&&i.I&&i.I(),f},null,{o:e});f&&d.Z()||(d=null)}var v;if(f){var m=d?function(e){return function(){return t(d()[e])}}:function(e){return f[e]},g=function(){return u.a.na(d?d():f,t)};g.get=function(e){return f[e]&&t(m(e))},g.has=function(e){return e in f},s=a(f),u.a.u(s,function(t){var n=t.zb.init,r=t.zb.update,s=t.key;if(8===e.nodeType&&!u.f.Q[s])throw Error("The binding '"+s+"' cannot be used with virtual elements");try{"function"==typeof n&&u.k.B(function(){var t=n(e,m(s),g,i.$data,i);if(t&&t.controlsDescendantBindings){if(v!==p)throw Error("Multiple bindings ("+v+" and "+s+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=s}}),"function"==typeof r&&u.j(function(){r(e,m(s),g,i.$data,i)},null,{o:e})}catch(o){throw o.message='Unable to process binding "'+s+": "+f[s]+'"\nMessage: '+o.message,o}})}return{shouldBindDescendants:v===p}}function l(e){return e&&e instanceof u.N?e:new u.N(e)}u.d={};var c={script:!0};u.getBindingHandler=function(e){return u.d[e]},u.N=function(e,t,n,r){var i=this,s="function"==typeof e&&!u.C(e),o,a=u.j(function(){var o=s?e():e,f=u.a.c(o);return t?(t.I&&t.I(),u.a.extend(i,t),a&&(i.I=a)):(i.$parents=[],i.$root=f,i.ko=u),i.$rawData=o,i.$data=f,n&&(i[n]=f),r&&r(i,t,f),i.$data},null,{Ia:function(){return o&&!u.a.ob(o)},o:!0});a.Z()&&(i.I=a,a.equalityComparer=null,o=[],a.Tb=function(e){o.push(e),u.a.w.da(e,function(e){u.a.ua(o,e),o.length||(a.K(),i.I=a=p)})})},u.N.prototype.createChildContext=function(e,t,n){return new u.N(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},u.N.prototype.extend=function(e){return new u.N(this.I||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,u.a.extend(t,"function"==typeof e?e():e)})};var h=u.a.e.F(),d=u.a.e.F();u.Ob=function(e,t){if(2!=arguments.length)return u.a.e.get(e,d);u.a.e.set(e,d,t),t.I&&t.I.Tb(e)},u.ra=function(e,t,n){return 1===e.nodeType&&u.f.Fb(e),f(e,t,l(n),!0)},u.Wb=function(t,r,i){return i=l(i),u.ra(t,"function"==typeof r?n(r.bind(null,i,t)):u.a.na(r,e),i)},u.Ca=function(e,t){1!==t.nodeType&&8!==t.nodeType||i(l(e),t,!0)},u.pb=function(e,t){!w&&s.jQuery&&(w=s.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||s.document.body,o(l(e),t,!0)},u.Ha=function(e){switch(e.nodeType){case 1:case 8:var t=u.Ob(e);if(t)return t;if(e.parentNode)return u.Ha(e.parentNode)}return p},u.$b=function(e){return(e=u.Ha(e))?e.$data:p},u.b("bindingHandlers",u.d),u.b("applyBindings",u.pb),u.b("applyBindingsToDescendants",u.Ca),u.b("applyBindingAccessorsToNode",u.ra),u.b("applyBindingsToNode",u.Wb),u.b("contextFor",u.Ha),u.b("dataFor",u.$b)}(),function(e){function t(t,r){var o=i.hasOwnProperty(t)?i[t]:e,a;o||(o=i[t]=new u.P,n(t,function(e){s[t]=e,delete i[t],a?o.notifySubscribers(e):setTimeout(function(){o.notifySubscribers(e)},0)}),a=!0),o.U(r)}function n(e,t){r("getConfig",[e],function(n){n?r("loadComponent",[e,n],function(e){t(e)}):t(null)})}function r(t,n,i,s){s||(s=u.g.loaders.slice(0));var o=s.shift();if(o){var a=o[t];if(a){var f=!1;if(a.apply(o,n.concat(function(e){f?i(null):null!==e?i(e):r(t,n,i,s)}))!==e&&(f=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(t,n,i,s)}else i(null)}var i={},s={};u.g={get:function(n,r){var i=s.hasOwnProperty(n)?s[n]:e;i?setTimeout(function(){r(i)},0):t(n,r)},tb:function(e){delete s[e]},jb:r},u.g.loaders=[],u.b("components",u.g),u.b("components.get",u.g.get),u.b("components.clearCachedDefinition",u.g.tb)}(),function(){function e(e,t,n,r){function i(){0===--a&&r(s)}var s={},a=2,f=n.template;n=n.viewModel,f?o(t,f,function(t){u.g.jb("loadTemplate",[e,t],function(e){s.template=e,i()})}):i(),n?o(t,n,function(t){u.g.jb("loadViewModel",[e,t],function(e){s[l]=e,i()})}):i()}function n(e,t,r){if("function"==typeof t)r(function(e){return new t(e)});else if("function"==typeof t[l])r(t[l]);else if("instance"in t){var i=t.instance;r(function(){return i})}else"viewModel"in t?n(e,t.viewModel,r):e("Unknown viewModel value: "+t)}function r(e){switch(u.a.t(e)){case"script":return u.a.ba(e.text);case"textarea":return u.a.ba(e.value);case"template":if(i(e.content))return u.a.ia(e.content.childNodes)}return u.a.ia(e.childNodes)}function i(e){return s.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,n,r){"string"==typeof n.require?t||s.require?(t||s.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function a(e){return function(t){throw Error("Component '"+e+"': "+t)}}var f={};u.g.tc=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(u.g.Qa(e))throw Error("Component "+e+" is already registered");f[e]=t},u.g.Qa=function(e){return e in f},u.g.wc=function(e){delete f[e],u.g.tb(e)},u.g.ub={getConfig:function(e,t){t(f.hasOwnProperty(e)?f[e]:null)},loadComponent:function(t,n,r){var i=a(t);o(i,n,function(n){e(t,i,n,r)})},loadTemplate:function(e,t,n){e=a(e);if("string"==typeof t)n(u.a.ba(t));else if(t instanceof Array)n(t);else if(i(t))n(u.a.S(t.childNodes));else if(t.element)if(t=t.element,s.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)n(r(t));else if("string"==typeof t){var o=v.getElementById(t);o?n(r(o)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,r){n(a(e),t,r)}};var l="createViewModel";u.b("components.register",u.g.tc),u.b("components.isRegistered",u.g.Qa),u.b("components.unregister",u.g.wc),u.b("components.defaultLoader",u.g.ub),u.g.loaders.push(u.g.ub),u.g.Ub=f}(),function(){function e(e,n){var r=e.getAttribute("params");if(r){var r=t.parseBindingsString(r,n,e,{valueAccessors:!0,bindingParams:!0}),r=u.a.na(r,function(t){return u.s(t,null,{o:e})}),i=u.a.na(r,function(t){return t.Z()?u.s(function(){return u.a.c(t())},null,{o:e}):t.v()});return i.hasOwnProperty("$raw")||(i.$raw=r),i}return{$raw:{}}}u.g.getComponentNameForNode=function(e){return e=u.a.t(e),u.g.Qa(e)&&e},u.g.mb=function(t,n,r,i){if(1===n.nodeType){var s=u.g.getComponentNameForNode(n);if(s){t=t||{};if(t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:s,params:e(n,r)};t.component=i?function(){return o}:o}}return t};var t=new u.J;9>u.a.L&&(u.g.register=function(e){return function(t){return v.createElement(t),e.apply(this,arguments)}}(u.g.register),v.createDocumentFragment=function(e){return function(){var t=e(),n=u.g.Ub,r;for(r in n)n.hasOwnProperty(r)&&t.createElement(r);return t}}(v.createDocumentFragment))}(),function(){var e=0;u.d.component={init:function(t,n,r,i,s){function o(){var e=a&&a.dispose;"function"==typeof e&&e.call(a),f=null}var a,f;return u.a.w.da(t,o),u.s(function(){var r=u.a.c(n()),i,l;"string"==typeof r?i=r:(i=u.a.c(r.name),l=u.a.c(r.params));if(!i)throw Error("No component name specified");var c=f=++e;u.g.get(i,function(e){if(f===c){o();if(!e)throw Error("Unknown component '"+i+"'");var n=e.template;if(!n)throw Error("Component '"+i+"' has no template");n=u.a.ia(n),u.f.T(t,n);var n=l,r=e.createViewModel;e=r?r.call(e,n,{element:t}):n,n=s.createChildContext(e),a=e,u.Ca(n,t)}})},null,{o:t}),{controlsDescendantBindings:!0}}},u.f.Q.component=!0}();var d={"class":"className","for":"htmlFor"};u.d.attr={update:function(e,t){var n=u.a.c(t())||{};u.a.G(n,function(t,n){n=u.a.c(n);var r=!1===n||null===n||n===p;r&&e.removeAttribute(t),8>=u.a.L&&t in d?(t=d[t],r?e.removeAttribute(t):e[t]=n):r||e.setAttribute(t,n.toString()),"name"===t&&u.a.Mb(e,r?"":n.toString())})}},function(){u.d.checked={after:["value","attr"],init:function(e,t,n){function r(){var r=e.checked,i=c?s():r;if(!u.Y.ma()&&(!a||r)){var o=u.k.B(t);f?l!==i?(r&&(u.a.ea(o,i,!0),u.a.ea(o,l,!1)),l=i):u.a.ea(o,i,r):u.h.pa(o,n,"checked",i,!0)}}function i(){var n=u.a.c(t());e.checked=f?0<=u.a.m(n,s()):o?n:s()===n}var s=u.Ib(function(){return n.has("checkedValue")?u.a.c(n.get("checkedValue")):n.has("value")?u.a.c(n.get("value")):e.value}),o="checkbox"==e.type,a="radio"==e.type;if(o||a){var f=o&&u.a.c(t())instanceof Array,l=f?s():p,c=a||f;a&&!e.name&&u.d.uniqueName.init(e,function(){return!0}),u.s(r,null,{o:e}),u.a.n(e,"click",r),u.s(i,null,{o:e})}}},u.h.V.checked=!0,u.d.checkedValue={update:function(e,t){e.value=u.a.c(t())}}}(),u.d.css={update:function(e,t){var n=u.a.c(t());"object"==typeof n?u.a.G(n,function(t,n){n=u.a.c(n),u.a.Ba(e,t,n)}):(n=String(n||""),u.a.Ba(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,u.a.Ba(e,n,!0))}},u.d.enable={update:function(e,t){var n=u.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},u.d.disable={update:function(e,t){u.d.enable.update(e,function(){return!u.a.c(t())})}},u.d.event={init:function(e,t,n,r,i){var s=t()||{};u.a.G(s,function(s){"string"==typeof s&&u.a.n(e,s,function(e){var o,a=t()[s];if(a){try{var f=u.a.S(arguments);r=i.$data,f.unshift(r),o=a.apply(r,f)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(s+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},u.d.foreach={Eb:function(e){return function(){var t=e(),n=u.a.Xa(t);return!n||"number"==typeof n.length?{foreach:t,templateEngine:u.O.Oa}:(u.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:u.O.Oa})}},init:function(e,t){return u.d.template.init(e,u.d.foreach.Eb(t))},update:function(e,t,n,r,i){return u.d.template.update(e,u.d.foreach.Eb(t),n,r,i)}},u.h.ha.foreach=!1,u.f.Q.foreach=!0,u.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var s;try{s=i.activeElement}catch(o){s=i.body}r=s===e}i=t(),u.h.pa(i,n,"hasfocus",r,!0),e.__ko_hasfocusLastValue=r,e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),s=r.bind(null,!1);u.a.n(e,"focus",i),u.a.n(e,"focusin",i),u.a.n(e,"blur",s),u.a.n(e,"focusout",s)},update:function(e,t){var n=!!u.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),u.k.B(u.a.oa,null,[e,n?"focusin":"focusout"]))}},u.h.V.hasfocus=!0,u.d.hasFocus=u.d.hasfocus,u.h.V.hasFocus=!0,u.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.$a(e,t())}},o("if"),o("ifnot",!1,!0),o("with",!0,!1,function(e,t){return e.createChildContext(t)});var m={};u.d.options={init:function(e){if("select"!==u.a.t(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function r(){return u.a.ta(e.options,function(e){return e.selected})}function i(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function s(t,n){if(c.length){var r=0<=u.a.m(c,u.i.q(n[0]));u.a.Nb(n[0],r),h&&!r&&u.k.B(u.a.oa,null,[e,"change"])}}var o=0!=e.length&&e.multiple?e.scrollTop:null,a=u.a.c(t()),f=n.get("optionsIncludeDestroyed");t={};var l,c;c=e.multiple?u.a.Da(r(),u.i.q):0<=e.selectedIndex?[u.i.q(e.options[e.selectedIndex])]:[],a&&("undefined"==typeof a.length&&(a=[a]),l=u.a.ta(a,function(e){return f||e===p||null===e||!u.a.c(e._destroy)}),n.has("optionsCaption")&&(a=u.a.c(n.get("optionsCaption")),null!==a&&a!==p&&l.unshift(m)));var h=!1;t.beforeRemove=function(t){e.removeChild(t)},a=s,n.has("optionsAfterRender")&&(a=function(e,t){s(0,t),u.k.B(n.get("optionsAfterRender"),null,[t[0],e!==m?e:p])}),u.a.Za(e,l,function(t,r,s){return s.length&&(c=s[0].selected?[u.i.q(s[0])]:[],h=!0),r=e.ownerDocument.createElement("option"),t===m?(u.a.bb(r,n.get("optionsCaption")),u.i.ca(r,p)):(s=i(t,n.get("optionsValue"),t),u.i.ca(r,u.a.c(s)),t=i(t,n.get("optionsText"),s),u.a.bb(r,t)),[r]},t,a),u.k.B(function(){n.get("valueAllowUnset")&&n.has("value")?u.i.ca(e,u.a.c(n.get("value")),!0):(e.multiple?c.length&&r().length<c.length:c.length&&0<=e.selectedIndex?u.i.q(e.options[e.selectedIndex])!==c[0]:c.length||0<=e.selectedIndex)&&u.a.oa(e,"change")}),u.a.dc(e),o&&20<Math.abs(o-e.scrollTop)&&(e.scrollTop=o)}},u.d.options.Va=u.a.e.F(),u.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){u.a.n(e,"change",function(){var r=t(),i=[];u.a.u(e.getElementsByTagName("option"),function(e){e.selected&&i.push(u.i.q(e))}),u.h.pa(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=u.a.t(e))throw Error("values binding applies only to SELECT elements");var n=u.a.c(t());n&&"number"==typeof n.length&&u.a.u(e.getElementsByTagName("option"),function(e){var t=0<=u.a.m(n,u.i.q(e));u.a.Nb(e,t)})}},u.h.V.selectedOptions=!0,u.d.style={update:function(e,t){var n=u.a.c(t()||{});u.a.G(n,function(t,n){n=u.a.c(n);if(null===n||n===p||!1===n)n="";e.style[t]=n})}},u.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");u.a.n(e,"submit",function(n){var r,s=t();try{r=s.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},u.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.bb(e,t())}},u.f.Q.text=!0,function(){if(s&&s.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=s.opera&&s.opera.version&&parseInt(s.opera.version()),n=s.navigator.userAgent,r=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>u.a.L)var o=u.a.e.F(),a=u.a.e.F(),f=function(e){var t=this.activeElement;(t=t&&u.a.e.get(t,a))&&t(e)},l=function(e,t){var n=e.ownerDocument;u.a.e.get(n,o)||(u.a.e.set(n,o,!0),u.a.n(n,"selectionchange",f)),u.a.e.set(e,a,t)};u.d.textInput={init:function(e,n,s){function o(t,n){u.a.n(e,t,n)}function a(){var t=u.a.c(n());if(null===t||t===p)t="";v!==p&&t===v?setTimeout(a,4):e.value!==t&&(h=t,e.value=t)}function f(){d||(v=e.value,d=setTimeout(c,4))}function c(){clearTimeout(d),v=d=p;var t=e.value;h!==t&&(h=t,u.h.pa(n(),s,"textInput",t))}var h=e.value,d,v;10>u.a.L?(o("propertychange",function(e){"value"===e.propertyName&&c()}),8==u.a.L&&(o("keyup",c),o("keydown",c)),8<=u.a.L&&(l(e,c),o("dragend",f))):(o("input",c),5>r&&"textarea"===u.a.t(e)?(o("keydown",f),o("paste",f),o("cut",f)):11>t?o("keydown",f):4>i&&(o("DOMAutoComplete",c),o("dragdrop",c),o("drop",c))),o("change",c),u.s(a,null,{o:e})}},u.h.V.textInput=!0,u.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),u.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++u.d.uniqueName.Zb;u.a.Mb(e,n)}}},u.d.uniqueName.Zb=0,u.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],i=n.get("valueUpdate"),s=!1,o=null;i&&("string"==typeof i&&(i=[i]),u.a.ga(r,i),r=u.a.rb(r));var a=function(){o=null,s=!1;var r=t(),i=u.i.q(e);u.h.pa(r,n,"value",i)};!u.a.L||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=u.a.m(r,"propertychange")||(u.a.n(e,"propertychange",function(){s=!0}),u.a.n(e,"focus",function(){s=!1}),u.a.n(e,"blur",function(){s&&a()})),u.a.u(r,function(t){var n=a;u.a.vc(t,"after")&&(n=function(){o=u.i.q(e),setTimeout(a,0)},t=t.substring(5)),u.a.n(e,t,n)});var f=function(){var r=u.a.c(t()),i=u.i.q(e);if(null!==o&&r===o)setTimeout(f,0);else if(r!==i)if("select"===u.a.t(e)){var s=n.get("valueAllowUnset"),i=function(){u.i.ca(e,r,s)};i(),s||r===u.i.q(e)?setTimeout(i,0):u.k.B(u.a.oa,null,[e,"change"])}else u.i.ca(e,r)};u.s(f,null,{o:e})}else u.ra(e,{checkedValue:t})},update:function(){}},u.h.V.value=!0,u.d.visible={update:function(e,t){var n=u.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}},function(e){u.d[e]={init:function(t,n,r,i,s){return u.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},r,i,s)}}}("click"),u.H=function(){},u.H.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},u.H.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},u.H.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||v;var n=t.getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new u.r.l(n)}if(1==e.nodeType||8==e.nodeType)return new u.r.fa(e);throw Error("Unknown template type: "+e)},u.H.prototype.renderTemplate=function(e,t,n,r){return e=this.makeTemplateSource(e,r),this.renderTemplateSource(e,t,n)},u.H.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")},u.H.prototype.rewriteTemplate=function(e,t,n){e=this.makeTemplateSource(e,n),t=t(e.text()),e.text(t),e.data("isRewritten",!0)},u.b("templateEngine",u.H),u.fb=function(){function e(e,t,n,r){e=u.h.Wa(e);for(var i=u.h.ha,s=0;s<e.length;s++){var o=e[s].key;if(i.hasOwnProperty(o)){var a=i[o];if("function"==typeof a){if(o=a(e[s].value))throw Error(o)}else if(!a)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+u.h.ya(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{ec:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return u.fb.nc(e,t)},n)},nc:function(r,i){return r.replace(t,function(t,n,r,s,o){return e(o,n,r,i)}).replace(n,function(t,n){return e(n,"<!-- ko -->","#comment",i)})},Xb:function(e,t){return u.D.Ua(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&u.ra(i,e,r)})}}}(),u.b("__tr_ambtns",u.fb.Xb),function(){u.r={},u.r.l=function(e){this.l=e},u.r.l.prototype.text=function(){var e=u.a.t(this.l),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.l[e];var t=arguments[0];"innerHTML"===e?u.a.$a(this.l,t):this.l[e]=t};var e=u.a.e.F()+"_";u.r.l.prototype.data=function(t){if(1===arguments.length)return u.a.e.get(this.l,e+t);u.a.e.set(this.l,e+t,arguments[1])};var t=u.a.e.F();u.r.fa=function(e){this.l=e},u.r.fa.prototype=new u.r.l,u.r.fa.prototype.text=function(){if(0==arguments.length){var e=u.a.e.get(this.l,t)||{};return e.gb===p&&e.Ga&&(e.gb=e.Ga.innerHTML),e.gb}u.a.e.set(this.l,t,{gb:arguments[0]})},u.r.l.prototype.nodes=function(){if(0==arguments.length)return(u.a.e.get(this.l,t)||{}).Ga;u.a.e.set(this.l,t,{Ga:arguments[0]})},u.b("templateSources",u.r),u.b("templateSources.domElement",u.r.l),u.b("templateSources.anonymousTemplate",u.r.fa)}(),function(){function e(e,t,n){var r;for(t=u.f.nextSibling(t);e&&(r=e)!==t;)e=u.f.nextSibling(r),n(r,e)}function t(t,n){if(t.length){var r=t[0],i=t[t.length-1],s=r.parentNode,o=u.J.instance,a=o.preprocessNode;if(a){e(r,i,function(e,t){var n=e.previousSibling,s=a.call(o,e);s&&(e===r&&(r=s[0]||t),e===i&&(i=s[s.length-1]||n))}),t.length=0;if(!r)return;r===i?t.push(r):(t.push(r,i),u.a.ka(t,s))}e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||u.pb(n,e)}),e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||u.D.Sb(e,[n])}),u.a.ka(t,s)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,r,s,o,a){a=a||{};var f=e&&n(e),f=f&&f.ownerDocument,l=a.templateEngine||i;u.fb.ec(s,l,f),s=l.renderTemplate(s,o,a,f);if("number"!=typeof s.length||0<s.length&&"number"!=typeof s[0].nodeType)throw Error("Template engine must return an array of DOM nodes");f=!1;switch(r){case"replaceChildren":u.f.T(e,s),f=!0;break;case"replaceNode":u.a.Lb(e,s),f=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+r)}return f&&(t(s,o),a.afterRender&&u.k.B(a.afterRender,null,[s,o.$data])),s}var i;u.ab=function(e){if(!(e==p||e instanceof u.H))throw Error("templateEngine must inherit from ko.templateEngine");i=e},u.Ya=function(e,t,s,o,a){s=s||{};if((s.templateEngine||i)==p)throw Error("Set a template engine before calling renderTemplate");a=a||"replaceChildren";if(o){var f=n(o);return u.j(function(){var i=t&&t instanceof u.N?t:new u.N(u.a.c(t)),l=u.C(e)?e():"function"==typeof e?e(i.$data,i):e,i=r(o,a,l,i,s);"replaceNode"==a&&(o=i,f=n(o))},null,{Ia:function(){return!f||!u.a.Ja(f)},o:f&&"replaceNode"==a?f.parentNode:f})}return u.D.Ua(function(n){u.Ya(e,t,s,n,"replaceNode")})},u.uc=function(e,n,i,s,o){function a(e,n){t(n,l),i.afterRender&&i.afterRender(n,e)}function f(t,n){l=o.createChildContext(t,i.as,function(e){e.$index=n});var s=u.C(e)?e():"function"==typeof e?e(t,l):e;return r(null,"ignoreTargetNode",s,l,i)}var l;return u.j(function(){var e=u.a.c(n)||[];"undefined"==typeof e.length&&(e=[e]),e=u.a.ta(e,function(e){return i.includeDestroyed||e===p||null===e||!u.a.c(e._destroy)}),u.k.B(u.a.Za,null,[s,e,f,i,a])},null,{o:s})};var s=u.a.e.F();u.d.template={init:function(e,t){var n=u.a.c(t());return"string"==typeof n||n.name?u.f.ja(e):(n=u.f.childNodes(e),n=u.a.oc(n),(new u.r.fa(e)).nodes(n)),{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var o=t(),a;t=u.a.c(o),n=!0,r=null,"string"==typeof t?t={}:(o=t.name,"if"in t&&(n=u.a.c(t["if"])),n&&"ifnot"in t&&(n=!u.a.c(t.ifnot)),a=u.a.c(t.data)),"foreach"in t?r=u.uc(o||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.createChildContext(a,t.as):i,r=u.Ya(o||e,i,t,e)):u.f.ja(e),i=r,(a=u.a.e.get(e,s))&&"function"==typeof a.K&&a.K(),u.a.e.set(e,s,i&&i.Z()?i:p)}},u.h.ha.template=function(e){return e=u.h.Wa(e),1==e.length&&e[0].unknown||u.h.lc(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},u.f.Q.template=!0}(),u.b("setTemplateEngine",u.ab),u.b("renderTemplate",u.Ya),u.a.wb=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index,u.moved=o.index,t.splice(s,1),r=s=0;break}r+=s}}},u.a.Fa=function(){function e(e,t,n,r,i){var s=Math.min,o=Math.max,a=[],f,l=e.length,c,h=t.length,p=h-l||1,d=l+h+1,v,m,g;for(f=0;f<=l;f++)for(m=v,a.push(v=[]),g=s(h,f+p),c=o(0,f-1);c<=g;c++)v[c]=c?f?e[f-1]===t[c-1]?m[c-1]:s(m[c]||d,v[c-1]||d)+1:c+1:f+1;s=[],o=[],p=[],f=l;for(c=h;f||c;)h=a[f][c]-1,c&&h===a[f][c-1]?o.push(s[s.length]={status:n,value:t[--c],index:c}):f&&h===a[f-1][c]?p.push(s[s.length]={status:r,value:e[--f],index:f}):(--c,--f,i.sparse||s.push({status:"retained",value:t[c]}));return u.a.wb(o,p,10*l),s.reverse()}return function(t,n,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],n=n||[],t.length<=n.length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}}(),u.b("utils.compareArrays",u.a.Fa),function(){function e(e,t,n,r,i){var s=[],o=u.j(function(){var o=t(n,i,u.a.ka(s,e))||[];0<s.length&&(u.a.Lb(s,o),r&&u.k.B(r,null,[n,o,i])),s.length=0,u.a.ga(s,o)},null,{o:e,Ia:function(){return!u.a.ob(s)}});return{$:s,j:o.Z()?o:p}}var t=u.a.e.F();u.a.Za=function(n,r,i,s,o){function a(e,t){S=c[t],g!==t&&(E[e]=S),S.Na(g++),u.a.ka(S.$,n),v.push(S),w.push(S)}function f(e,t){if(e)for(var n=0,r=t.length;n<r;n++)t[n]&&u.a.u(t[n].$,function(r){e(r,n,t[n].sa)})}r=r||[],s=s||{};var l=u.a.e.get(n,t)===p,c=u.a.e.get(n,t)||[],h=u.a.Da(c,function(e){return e.sa}),d=u.a.Fa(h,r,s.dontLimitMoves),v=[],m=0,g=0,y=[],w=[];r=[];for(var E=[],h=[],S,x=0,T,N;T=d[x];x++)switch(N=T.moved,T.status){case"deleted":N===p&&(S=c[m],S.j&&S.j.K(),y.push.apply(y,u.a.ka(S.$,n)),s.beforeRemove&&(r[x]=S,w.push(S))),m++;break;case"retained":a(x,m++);break;case"added":N!==p?a(x,N):(S={sa:T.value,Na:u.p(g++)},v.push(S),w.push(S),l||(h[x]=S))}f(s.beforeMove,E),u.a.u(y,s.beforeRemove?u.R:u.removeNode);for(var x=0,l=u.f.firstChild(n),C;S=w[x];x++){S.$||u.a.extend(S,e(n,i,S.sa,o,S.Na));for(m=0;d=S.$[m];l=d.nextSibling,C=d,m++)d!==l&&u.f.Bb(n,d,C);!S.ic&&o&&(o(S.sa,S.$,S.Na),S.ic=!0)}f(s.beforeRemove,r),f(s.afterMove,E),f(s.afterAdd,h),u.a.e.set(n,t,v)}}(),u.b("utils.setDomNodeChildrenFromArrayMapping",u.a.Za),u.O=function(){this.allowTemplateRewriting=!1},u.O.prototype=new u.H,u.O.prototype.renderTemplateSource=function(e){var t=(9>u.a.L?0:e.nodes)?e.nodes():null;return t?u.a.S(t.cloneNode(!0).childNodes):(e=e.text(),u.a.ba(e))},u.O.Oa=new u.O,u.ab(u.O.Oa),u.b("nativeTemplateEngine",u.O),function(){u.Sa=function(){var e=this.kc=function(){if(!w||!w.tmpl)return 0;try{if(0<=w.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,r){r=r||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var i=t.data("precompiled");return i||(i=t.text()||"",i=w.template(null,"{{ko_with $item.koBindingContext}}"+i+"{{/ko_with}}"),t.data("precompiled",i)),t=[n.$data],n=w.extend({koBindingContext:n},r.templateOptions),n=w.tmpl(i,t,n),n.appendTo(v.createElement("div")),w.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){v.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},0<e&&(w.tmpl.tag.ko_code={open:"__.push($1 || '');"},w.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},u.Sa.prototype=new u.H;var e=new u.Sa;0<e.kc&&u.ab(e),u.b("jqueryTmplTemplateEngine",u.Sa)}()})})()}(),define("cookies",{year:"year",group_id:"group_id",discipline_id:"discipline_id",sorting:"students-sorting",score_method:"score-method",keep_mark_table_open:"keep_mark_table_open",expires:7}),function(e){typeof define=="function"&&define.amd?define("helpers",e):typeof exports=="object"?e():window.helpers=e()}(function(){return Date.prototype.ddmmyyyy=function(){var e=this.getFullYear().toString(),t=(this.getMonth()+1).toString(),n=this.getDate().toString();return(n[1]?n:"0"+n[0])+"/"+(t[1]?t:"0"+t[0])+"/"+e},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;t<n;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},{extend:function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.superclass=t.prototype},blink:function(e,t){var n=$("body"),r=n.css("background");n.css("background-color",e),setTimeout(function(){$("body").css("background",r)},t)},showSuccess:function(){this.blink("#AAFF88",1e3)},showFail:function(){this.blink("#FFAA88",1e3)},csrfize:function(t){return t.csrfmiddlewaretoken=$.cookie("csrftoken"),t},post:function(e,t,n,r){var i=this;$.post(e,this.csrfize(t)).done(function(e){n&&n(e),i.showSuccess()}).fail(function(e){r&&r(e),i.showFail()})},get:function(e,t,n,r){var i=this;$.get(e,t).done(function(e){n&&n(e),i.showSuccess()}).fail(function(e){r&&r(e),i.showFail()})},input2base64f:function(e,t){var n=e.files[0],r=new FileReader;r.onload=function(e){t&&t(e)},r.readAsDataURL(n)},input2base64:function(e,t){this.input2base64f(e,function(e){t.src=e.target.result})}}}),define("marks/discipline",["knockout","urls","helpers"],function(e,t,n){return function(r,i){var s=this;s.model=i,s.id=r.id,s.year=e.observable(r.year),s.title=e.observable(r.title),s.visible=e.observable(r.visible),s.edit=function(){$.prompt({state0:{title:"",html:'<label> : <input type="text" name="title" value="'+s.title()+'">'+"</label>",buttons:{"":!0,"":!1},submit:function(e,t,n,r){t&&(s.title(r.title),s.save())}}})},s.save=function(e,r){$.post(t.url.discipline_edit,n.csrfize({id:s.id,title:s.title(),year:s.year(),visible:s.visible()})).done(function(t){e&&e(t),n.showSuccess()}).fail(function(){r&&r(d),n.showFail()})},s.add=function(e,r){$.post(t.url.discipline_add,n.csrfize({title:s.title(),year:s.year(),visible:s.visible()})).done(function(t){e&&e(t),n.showSuccess()}).fail(function(){r&&r(d),n.showFail()})},s.remove=function(e,r){$.prompt(" :"+s.title()+"?",{title:"",buttons:{"":!0," ":!1},submit:function(i,o,u,a){o&&$.post(t.url.discipline_remove,n.csrfize({id:s.id})).done(function(t){e&&e(t),n.showSuccess()}).fail(function(){r&&r(d),n.showFail()})}})},s.toggle=function(){s.visible(!s.visible()),s.save(null,function(){s.visible(!s.visible())})}}}),define("marks/lesson",["knockout","helpers","urls"],function(e,t,n){return function(r,i){var s=this;s.convert_date=function(e){var t=new Date(e);return t.ddmmyyyy()},s.date=e.observable(s.convert_date(r.dt)),s.lesson_type=e.observable(r.lt),s.description=e.observable(r.dn),s.description_raw=e.observable(r.dn_raw),s.multiplier=e.observable(r.k),s.score_ignore=e.observable(r.si),s.isodate_old=r.dt,s.fa_icon=e.observable(r.fi?r.fi:""),s.id=r.id,s.icon_has_loaded=e.observable(!1),s.icon_id=e.observable(r.icn_id),s.icn_fld_id=e.observable(r.icn_fld_id),s.icon_url=e.observable(r.icn_url),s.icon_edit_url=e.pureComputed(function(){var e=s.icn_fld_id();if(e==""||e==null)e="";return"/admin/filer/folder/"+(e==""?"":e+"/list/")}),s.label=e.pureComputed(function(){return s.date().split("/")[0]},s.date),s.info=e.pureComputed(function(){return"<p><p align=left>"+s.date()+"<p>"+s.description()},s.description),s.style=e.pureComputed(function(){switch(s.lesson_type()){case 2:return"test";case 3:return"lect";case 4:return"laba";case 5:return"exam"}return""},s.lesson_type),s.isodate=e.pureComputed(function(){var e=new Date(s.isodate_old),t=s.date().split("/");return t[2]+"-"+t[1]+"-"+t[0]},s.date),s.clearIcon=function(){s.icon_id(null),s.icn_fld_id(""),s.icon_url("")},s.remove=function(e,r){$.prompt(" ?",{title:"",buttons:{"":!0," ":!1},submit:function(i,o,u,a){o&&$.post(n.url.lesson_remove,t.csrfize({lesson_id:s.id})).done(function(n){e&&e(n),t.showSuccess()}).fail(function(){r&&r(d),t.showFail()})}})}}}),define("marks/mark",["knockout"],function(e){return function(t){var n=this;n.student_id=t.sid,n.student=t.student,n.mark_id=t.mid,n.lesson_id=t.lid,n.mark=e.observable(t.m),n.mark_old=e.observable(t.m),n.lesson=t.lesson,n.ignore_lesson=function(){return n.lesson.score_ignore()||n.lesson.lesson_type()==5};var r=t.m;n.mark.subscribe(function(){if(n.student){var e=n.student.marks,t=0,i=0;for(var s=0;s<e.length;++s){e[s].ignore_lesson()||++i;if(e[s].lesson.lesson_type()==5)continue;var o=e[s],u=marksTypes[o.mark()];switch(u){case"black-hole":t>0&&(t=0);break;case"shining":t<i*3?t=i*3:s+1==e.length&&(t=i*30+i*30/70*27);break;case"mercy":t<0&&(t=0);break;default:t+=o.mark()}}r=n.mark(),n.student.sum(t)}}),n.mark_text=e.pureComputed(function(){return""},n.mark),n.mark_class=e.pureComputed(function(){var e=marksTypes[n.mark()];return e+=n.mark()!=n.mark_old()?" modified":"",e+=n.lesson.style()?" "+n.lesson.style():"",e},n.mark,n.mark_old),n.reset=function(){n.mark_old(n.mark())},n.modified=e.pureComputed(function(){return n.mark()!=n.mark_old()},n.mark,n.mark_old),n.increase=function(){var e=n.mark();e=Math.min(e+1,marksTypes.max),n.mark(e)},n.decrease=function(){var e=n.mark();e=Math.max(e-1,marksTypes.min),n.mark(e)}}}),function(e,t,n){function r(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var i=e[n][1][t];return r(i?i:t)},u,u.exports)}return t[n].exports}var i=typeof require=="function"&&require;for(var s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,n){Color=e("./color")},{"./color":2}],2:[function(e,t,n){var r=e("color-convert"),i=e("color-string");t.exports=function(e){return new s(e)};var s=function(e){this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};if(typeof e=="string"){var t=i.getRgba(e);if(t)this.setValues("rgb",t);else if(t=i.getHsla(e))this.setValues("hsl",t);else{if(!(t=i.getHwb(e)))throw new Error("Unable to parse color from string "+e);this.setValues("hwb",t)}}else if(typeof e=="object"){var t=e;if(t.r!==undefined||t.red!==undefined)this.setValues("rgb",t);else if(t.l!==undefined||t.lightness!==undefined)this.setValues("hsl",t);else if(t.v!==undefined||t.value!==undefined)this.setValues("hsv",t);else if(t.w!==undefined||t.whiteness!==undefined)this.setValues("hwb",t);else{if(t.c===undefined&&t.cyan===undefined)throw new Error("Unable to parse color from object "+JSON.stringify(e));this.setValues("cmyk",t)}}};s.prototype={rgb:function(e){return this.setSpace("rgb",arguments)},hsl:function(e){return this.setSpace("hsl",arguments)},hsv:function(e){return this.setSpace("hsv",arguments)},hwb:function(e){return this.setSpace("hwb",arguments)},cmyk:function(e){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){return this.values.alpha!==1?this.values.hwb.concat([this.values.alpha]):this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values.rgb;return e.concat([this.values.alpha])},hslaArray:function(){var e=this.values.hsl;return e.concat([this.values.alpha])},alpha:function(e){return e===undefined?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return i.hexString(this.values.rgb)},rgbString:function(){return i.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return i.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return i.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return i.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return i.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return i.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return i.keyword(this.values.rgb,this.values.alpha)},luminosity:function(){var e=this.values.rgb,t=[];for(var n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb,t=(e[0]*299+e[1]*587+e[2]*114)/1e3;return t<128},light:function(){return!this.dark()},negate:function(){var e=[];for(var t=0;t<3;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){return this.values.hsl[2]+=this.values.hsl[2]*e,this.setValues("hsl",this.values.hsl),this},darken:function(e){return this.values.hsl[2]-=this.values.hsl[2]*e,this.setValues("hsl",this.values.hsl),this},saturate:function(e){return this.values.hsl[1]+=this.values.hsl[1]*e,this.setValues("hsl",this.values.hsl),this},desaturate:function(e){return this.values.hsl[1]-=this.values.hsl[1]*e,this.setValues("hsl",this.values.hsl),this},whiten:function(e){return this.values.hwb[1]+=this.values.hwb[1]*e,this.setValues("hwb",this.values.hwb),this},blacken:function(e){return this.values.hwb[2]+=this.values.hwb[2]*e,this.setValues("hwb",this.values.hwb),this},greyscale:function(){var e=this.values.rgb,t=e[0]*.3+e[1]*.59+e[2]*.11;return this.setValues("rgb",[t,t,t]),this},clearer:function(e){return this.setValues("alpha",this.values.alpha-this.values.alpha*e),this},opaquer:function(e){return this.setValues("alpha",this.values.alpha+this.values.alpha*e),this},rotate:function(e){var t=this.values.hsl[0];return t=(t+e)%360,t=t<0?360+t:t,this.values.hsl[0]=t,this.setValues("hsl",this.values.hsl),this},mix:function(e,t){t=1-(t==null?.5:t);var n=t*2-1,r=this.alpha()-e.alpha(),i=((n*r==-1?n:(n+r)/(1+n*r))+1)/2,s=1-i,o=this.rgbArray(),u=e.rgbArray();for(var a=0;a<o.length;a++)o[a]=o[a]*i+u[a]*s;this.setValues("rgb",o);var f=this.alpha()*t+e.alpha()*(1-t);return this.setValues("alpha",f),this},toJSON:function(){return this.rgb()},clone:function(){return new s(this.rgb())}},s.prototype.getValues=function(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=this.values[e][n];return this.values.alpha!=1&&(t.a=this.values.alpha),t},s.prototype.setValues=function(e,t){var n={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},i={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},s=1;if(e=="alpha")s=t;else if(t.length)this.values[e]=t.slice(0,e.length),s=t[e.length];else if(t[e[0]]!==undefined){for(var o=0;o<e.length;o++)this.values[e][o]=t[e[o]];s=t.a}else if(t[n[e][0]]!==undefined){var u=n[e];for(var o=0;o<e.length;o++)this.values[e][o]=t[u[o]];s=t.alpha}this.values.alpha=Math.max(0,Math.min(1,s!==undefined?s:this.values.alpha));if(e=="alpha")return;for(var o=0;o<e.length;o++){var a=Math.max(0,Math.min(i[e][o],this.values[e][o]));this.values[e][o]=Math.round(a)}for(var f in n){f!=e&&(this.values[f]=r[e][f](this.values[e]));for(var o=0;o<f.length;o++){var a=Math.max(0,Math.min(i[f][o],this.values[f][o]));this.values[f][o]=Math.round(a)}}return!0},s.prototype.setSpace=function(e,t){var n=t[0];return n===undefined?this.getValues(e):(typeof n=="number"&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},s.prototype.setChannel=function(e,t,n){return n===undefined?this.values[e][t]:(this.values[e][t]=n,this.setValues(e,this.values[e]),this)}},{"color-string":3,"color-convert":4}],4:[function(e,t,n){var r=e("./conversions"),i=function(){return new f};for(var s in r){i[s+"Raw"]=function(e){return function(t){return typeof t=="number"&&(t=Array.prototype.slice.call(arguments)),r[e](t)}}(s);var o=/(\w+)2(\w+)/.exec(s),u=o[1],a=o[2];i[u]=i[u]||{},i[u][a]=i[s]=function(e){return function(t){typeof t=="number"&&(t=Array.prototype.slice.call(arguments));var n=r[e](t);if(typeof n=="string"||n===undefined)return n;for(var i=0;i<n.length;i++)n[i]=Math.round(n[i]);return n}}(s)}var f=function(){this.convs={}};f.prototype.routeSpace=function(e,t){var n=t[0];return n===undefined?this.getValues(e):(typeof n=="number"&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},f.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},f.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space,r=this.convs[n];t=i[n][e](r),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){f.prototype[e]=function(t){return this.routeSpace(e,arguments)}}),t.exports=i},{"./conversions":5}],5:[function(e,t,n){function i(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u,a,f;return s==i?u=0:t==s?u=(n-r)/o:n==s?u=2+(r-t)/o:r==s&&(u=4+(t-n)/o),u=Math.min(u*60,360),u<0&&(u+=360),f=(i+s)/2,s==i?a=0:f<=.5?a=o/(s+i):a=o/(2-s-i),[u,a*100,f*100]}function s(e){var t=e[0],n=e[1],r=e[2],i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u,a,f;return s==0?a=0:a=o/s*1e3/10,s==i?u=0:t==s?u=(n-r)/o:n==s?u=2+(r-t)/o:r==s&&(u=4+(t-n)/o),u=Math.min(u*60,360),u<0&&(u+=360),f=s/255*1e3/10,[u,a,f]}function o(e){var t=e[0],n=e[1],r=e[2],s=i(e)[0];return w=1/255*Math.min(t,Math.min(n,r)),r=1-1/255*Math.max(t,Math.max(n,r)),[s,w*100,r*100]}function u(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i,s,o,u;return u=Math.min(1-t,1-n,1-r),i=(1-t-u)/(1-u),s=(1-n-u)/(1-u),o=(1-r-u)/(1-u),[i*100,s*100,o*100,u*100]}function a(e){return Y[JSON.stringify(e)]}function f(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var i=t*.4124+n*.3576+r*.1805,s=t*.2126+n*.7152+r*.0722,o=t*.0193+n*.1192+r*.9505;return[i*100,s*100,o*100]}function l(e){var t=f(e),n=t[0],r=t[1],i=t[2],s,o,u;return n/=95.047,r/=100,i/=108.883,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,s=116*r-16,o=500*(n-r),u=200*(r-i),[s,o,u]}function c(e){return I(l(e))}function h(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100,i,s,o,u,a;if(n==0)return a=r*255,[a,a,a];r<.5?s=r*(1+n):s=r+n-r*n,i=2*r-s,u=[0,0,0];for(var f=0;f<3;f++)o=t+1/3*-(f-1),o<0&&o++,o>1&&o--,6*o<1?a=i+(s-i)*6*o:2*o<1?a=s:3*o<2?a=i+(s-i)*(2/3-o)*6:a=i,u[f]=a*255;return u}function p(e){var t=e[0],n=e[1]/100,r=e[2]/100,i,s;return r*=2,n*=r<=1?r:2-r,s=(r+n)/2,i=2*n/(r+n),[t,i*100,s*100]}function d(e){return o(h(e))}function v(e){return u(h(e))}function m(e){return a(h(e))}function y(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),o=255*r*(1-n),u=255*r*(1-n*s),a=255*r*(1-n*(1-s)),r=255*r;switch(i){case 0:return[r,a,o];case 1:return[u,r,o];case 2:return[o,r,a];case 3:return[o,u,r];case 4:return[a,o,r];case 5:return[r,o,u]}}function E(e){var t=e[0],n=e[1]/100,r=e[2]/100,i,s;return s=(2-n)*r,i=n*r,i/=s<=1?s:2-s,s/=2,[t,i*100,s*100]}function S(e){return o(y(e))}function x(e){return u(y(e))}function T(e){return a(y(e))}function N(e){var t=e[0]/360,n=e[1]/100,i=e[2]/100,s=n+i,o,u,a,f;s>1&&(n/=s,i/=s),o=Math.floor(6*t),u=1-i,a=6*t-o,(o&1)!=0&&(a=1-a),f=n+a*(u-n);switch(o){default:case 6:case 0:r=u,g=f,b=n;break;case 1:r=f,g=u,b=n;break;case 2:r=n,g=u,b=f;break;case 3:r=n,g=f,b=u;break;case 4:r=f,g=n,b=u;break;case 5:r=u,g=n,b=f}return[r*255,g*255,b*255]}function C(e){return i(N(e))}function k(e){return s(N(e))}function L(e){return u(N(e))}function A(e){return a(N(e))}function O(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100,s,o,u;return s=1-Math.min(1,t*(1-i)+i),o=1-Math.min(1,n*(1-i)+i),u=1-Math.min(1,r*(1-i)+i),[s*255,o*255,u*255]}function M(e){return i(O(e))}function _(e){return s(O(e))}function D(e){return o(O(e))}function P(e){return a(O(e))}function H(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i,s,o;return i=t*3.2406+n*-1.5372+r*-0.4986,s=t*-0.9689+n*1.8758+r*.0415,o=t*.0557+n*-0.204+r*1.057,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*=12.92,i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),[i*255,s*255,o*255]}function B(e){var t=e[0],n=e[1],r=e[2],i,s,o;return t/=95.047,n/=100,r/=108.883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=116*n-16,s=500*(t-n),o=200*(n-r),[i,s,o]}function j(e){return I(B(e))}function F(e){var t=e[0],n=e[1],r=e[2],i,s,o,u;return t<=8?(s=t*100/903.3,u=7.787*(s/100)+16/116):(s=100*Math.pow((t+16)/116,3),u=Math.pow(s/100,1/3)),i=i/95.047<=.008856?i=95.047*(n/500+u-16/116)/7.787:95.047*Math.pow(n/500+u,3),o=o/108.883<=.008859?o=108.883*(u-r/200-16/116)/7.787:108.883*Math.pow(u-r/200,3),[i,s,o]}function I(e){var t=e[0],n=e[1],r=e[2],i,s,o;return i=Math.atan2(r,n),s=i*360/2/Math.PI,s<0&&(s+=360),o=Math.sqrt(n*n+r*r),[t,o,s]}function q(e){return H(F(e))}function R(e){var t=e[0],n=e[1],r=e[2],i,s,o;return o=r/360*2*Math.PI,i=n*Math.cos(o),s=n*Math.sin(o),[t,i,s]}function U(e){return F(R(e))}function z(e){return q(R(e))}function W(e){return G[e]}function X(e){return i(W(e))}function V(e){return s(W(e))}function $(e){return o(W(e))}function J(e){return u(W(e))}function K(e){return l(W(e))}function Q(e){return f(W(e))}t.exports={rgb2hsl:i,rgb2hsv:s,rgb2hwb:o,rgb2cmyk:u,rgb2keyword:a,rgb2xyz:f,rgb2lab:l,rgb2lch:c,hsl2rgb:h,hsl2hsv:p,hsl2hwb:d,hsl2cmyk:v,hsl2keyword:m,hsv2rgb:y,hsv2hsl:E,hsv2hwb:S,hsv2cmyk:x,hsv2keyword:T,hwb2rgb:N,hwb2hsl:C,hwb2hsv:k,hwb2cmyk:L,hwb2keyword:A,cmyk2rgb:O,cmyk2hsl:M,cmyk2hsv:_,cmyk2hwb:D,cmyk2keyword:P,keyword2rgb:W,keyword2hsl:X,keyword2hsv:V,keyword2hwb:$,keyword2cmyk:J,keyword2lab:K,keyword2xyz:Q,xyz2rgb:H,xyz2lab:B,xyz2lch:j,lab2xyz:F,lab2rgb:q,lab2lch:I,lch2lab:R,lch2xyz:U,lch2rgb:z};var G={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Y={};for(var Z in G)Y[JSON.stringify(G[Z])]=Z},{}],3:[function(e,t,n){function i(e){if(!e)return;var t=/^#([a-fA-F0-9]{3})$/,n=/^#([a-fA-F0-9]{6})$/,i=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([\d\.]+)\s*)?\)$/,s=/^rgba?\(\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*(?:,\s*([\d\.]+)\s*)?\)$/,o=/(\D+)/,u=[0,0,0],a=1,f=e.match(t);if(f){f=f[1];for(var l=0;l<u.length;l++)u[l]=parseInt(f[l]+f[l],16)}else if(f=e.match(n)){f=f[1];for(var l=0;l<u.length;l++)u[l]=parseInt(f.slice(l*2,l*2+2),16)}else if(f=e.match(i)){for(var l=0;l<u.length;l++)u[l]=parseInt(f[l+1]);a=parseFloat(f[4])}else if(f=e.match(s)){for(var l=0;l<u.length;l++)u[l]=Math.round(parseFloat(f[l+1])*2.55);a=parseFloat(f[4])}else if(f=e.match(o)){if(f[1]=="transparent")return[0,0,0,0];u=r.keyword2rgb(f[1]);if(!u)return}for(var l=0;l<u.length;l++)u[l]=b(u[l],0,255);return!a&&a!=0?a=1:a=b(a,0,1),u.push(a),u}function s(e){if(!e)return;var t=/^hsla?\(\s*(\d+)\s*,\s*([\d\.]+)%\s*,\s*([\d\.]+)%\s*(?:,\s*([\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=b(parseInt(n[1]),0,360),i=b(parseFloat(n[2]),0,100),s=b(parseFloat(n[3]),0,100),o=b(parseFloat(n[4])||1,0,1);return[r,i,s,o]}}function o(e){if(!e)return;var t=/^hwb\(\s*(\d+)\s*,\s*([\d\.]+)%\s*,\s*([\d\.]+)%\s*(?:,\s*([\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=b(parseInt(n[1]),0,360),i=b(parseFloat(n[2]),0,100),s=b(parseFloat(n[3]),0,100),o=b(parseFloat(n[4])||1,0,1);return[r,i,s,o]}}function u(e){var t=i(e);return t&&t.slice(0,3)}function a(e){var t=s(e);return t&&t.slice(0,3)}function f(e){var t=i(e);if(t)return t[3];if(t=s(e))return t[3];if(t=o(e))return t[3]}function l(e){return"#"+w(e[0])+w(e[1])+w(e[2])}function c(e,t){return t<1||e[3]&&e[3]<1?h(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"}function h(e,t){return t===undefined&&(t=e[3]!==undefined?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function p(e,t){if(t<1||e[3]&&e[3]<1)return d(e,t);var n=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgb("+n+"%, "+r+"%, "+i+"%)"}function d(e,t){var n=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgba("+n+"%, "+r+"%, "+i+"%, "+(t||e[3]||1)+")"}function v(e,t){return t<1||e[3]&&e[3]<1?m(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"}function m(e,t){return t===undefined&&(t=e[3]!==undefined?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function g(e,t){return t===undefined&&(t=e[3]!==undefined?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(t!==undefined&&t!==1?", "+t:"")+")"}function y(e){return r.rgb2keyword(e.slice(0,3))}function b(e,t,n){return Math.min(Math.max(t,e),n)}function w(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var r=e("color-convert");t.exports={getRgba:i,getHsla:s,getRgb:u,getHsl:a,getHwb:o,getAlpha:f,hexString:l,rgbString:c,rgbaString:h,percentString:p,percentaString:d,hslString:v,hslaString:m,hwbString:g,keyword:y}},{"color-convert":6}],6:[function(e,t,n){var r=e("./conversions"),i=function(){return new f};for(var s in r){i[s+"Raw"]=function(e){return function(t){return typeof t=="number"&&(t=Array.prototype.slice.call(arguments)),r[e](t)}}(s);var o=/(\w+)2(\w+)/.exec(s),u=o[1],a=o[2];i[u]=i[u]||{},i[u][a]=i[s]=function(e){return function(t){typeof t=="number"&&(t=Array.prototype.slice.call(arguments));var n=r[e](t);if(typeof n=="string"||n===undefined)return n;for(var i=0;i<n.length;i++)n[i]=Math.round(n[i]);return n}}(s)}var f=function(){this.convs={}};f.prototype.routeSpace=function(e,t){var n=t[0];return n===undefined?this.getValues(e):(typeof n=="number"&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},f.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},f.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space,r=this.convs[n];t=i[n][e](r),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){f.prototype[e]=function(t){return this.routeSpace(e,arguments)}}),t.exports=i},{"./conversions":7}],7:[function(e,t,n){function i(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u,a,f;return s==i?u=0:t==s?u=(n-r)/o:n==s?u=2+(r-t)/o:r==s&&(u=4+(t-n)/o),u=Math.min(u*60,360),u<0&&(u+=360),f=(i+s)/2,s==i?a=0:f<=.5?a=o/(s+i):a=o/(2-s-i),[u,a*100,f*100]}function s(e){var t=e[0],n=e[1],r=e[2],i=Math.min(t,n,r),s=Math.max(t,n,r),o=s-i,u,a,f;return s==0?a=0:a=o/s*1e3/10,s==i?u=0:t==s?u=(n-r)/o:n==s?u=2+(r-t)/o:r==s&&(u=4+(t-n)/o),u=Math.min(u*60,360),u<0&&(u+=360),f=s/255*1e3/10,[u,a,f]}function o(e){var t=e[0],n=e[1],r=e[2],s=i(e)[0];return w=1/255*Math.min(t,Math.min(n,r)),r=1-1/255*Math.max(t,Math.max(n,r)),[s,w*100,r*100]}function u(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i,s,o,u;return u=Math.min(1-t,1-n,1-r),i=(1-t-u)/(1-u),s=(1-n-u)/(1-u),o=(1-r-u)/(1-u),[i*100,s*100,o*100,u*100]}function a(e){return Y[JSON.stringify(e)]}function f(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var i=t*.4124+n*.3576+r*.1805,s=t*.2126+n*.7152+r*.0722,o=t*.0193+n*.1192+r*.9505;return[i*100,s*100,o*100]}function l(e){var t=f(e),n=t[0],r=t[1],i=t[2],s,o,u;return n/=95.047,r/=100,i/=108.883,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,s=116*r-16,o=500*(n-r),u=200*(r-i),[s,o,u]}function c(e){return I(l(e))}function h(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100,i,s,o,u,a;if(n==0)return a=r*255,[a,a,a];r<.5?s=r*(1+n):s=r+n-r*n,i=2*r-s,u=[0,0,0];for(var f=0;f<3;f++)o=t+1/3*-(f-1),o<0&&o++,o>1&&o--,6*o<1?a=i+(s-i)*6*o:2*o<1?a=s:3*o<2?a=i+(s-i)*(2/3-o)*6:a=i,u[f]=a*255;return u}function p(e){var t=e[0],n=e[1]/100,r=e[2]/100,i,s;return r*=2,n*=r<=1?r:2-r,s=(r+n)/2,i=2*n/(r+n),[t,i*100,s*100]}function d(e){return o(h(e))}function v(e){return u(h(e))}function m(e){return a(h(e))}function y(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),o=255*r*(1-n),u=255*r*(1-n*s),a=255*r*(1-n*(1-s)),r=255*r;switch(i){case 0:return[r,a,o];case 1:return[u,r,o];case 2:return[o,r,a];case 3:return[o,u,r];case 4:return[a,o,r];case 5:return[r,o,u]}}function E(e){var t=e[0],n=e[1]/100,r=e[2]/100,i,s;return s=(2-n)*r,i=n*r,i/=s<=1?s:2-s,s/=2,[t,i*100,s*100]}function S(e){return o(y(e))}function x(e){return u(y(e))}function T(e){return a(y(e))}function N(e){var t=e[0]/360,n=e[1]/100,i=e[2]/100,s=n+i,o,u,a,f;s>1&&(n/=s,i/=s),o=Math.floor(6*t),u=1-i,a=6*t-o,(o&1)!=0&&(a=1-a),f=n+a*(u-n);switch(o){default:case 6:case 0:r=u,g=f,b=n;break;case 1:r=f,g=u,b=n;break;case 2:r=n,g=u,b=f;break;case 3:r=n,g=f,b=u;break;case 4:r=f,g=n,b=u;break;case 5:r=u,g=n,b=f}return[r*255,g*255,b*255]}function C(e){return i(N(e))}function k(e){return s(N(e))}function L(e){return u(N(e))}function A(e){return a(N(e))}function O(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100,s,o,u;return s=1-Math.min(1,t*(1-i)+i),o=1-Math.min(1,n*(1-i)+i),u=1-Math.min(1,r*(1-i)+i),[s*255,o*255,u*255]}function M(e){return i(O(e))}function _(e){return s(O(e))}function D(e){return o(O(e))}function P(e){return a(O(e))}function H(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i,s,o;return i=t*3.2406+n*-1.5372+r*-0.4986,s=t*-0.9689+n*1.8758+r*.0415,o=t*.0557+n*-0.204+r*1.057,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*=12.92,i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),[i*255,s*255,o*255]}function B(e){var t=e[0],n=e[1],r=e[2],i,s,o;return t/=95.047,n/=100,r/=108.883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=116*n-16,s=500*(t-n),o=200*(n-r),[i,s,o]}function j(e){return I(B(e))}function F(e){var t=e[0],n=e[1],r=e[2],i,s,o,u;return t<=8?(s=t*100/903.3,u=7.787*(s/100)+16/116):(s=100*Math.pow((t+16)/116,3),u=Math.pow(s/100,1/3)),i=i/95.047<=.008856?i=95.047*(n/500+u-16/116)/7.787:95.047*Math.pow(n/500+u,3),o=o/108.883<=.008859?o=108.883*(u-r/200-16/116)/7.787:108.883*Math.pow(u-r/200,3),[i,s,o]}function I(e){var t=e[0],n=e[1],r=e[2],i,s,o;return i=Math.atan2(r,n),s=i*360/2/Math.PI,s<0&&(s+=360),o=Math.sqrt(n*n+r*r),[t,o,s]}function q(e){return H(F(e))}function R(e){var t=e[0],n=e[1],r=e[2],i,s,o;return o=r/360*2*Math.PI,i=n*Math.cos(o),s=n*Math.sin(o),[t,i,s]}function U(e){return F(R(e))}function z(e){return q(R(e))}function W(e){return G[e]}function X(e){return i(W(e))}function V(e){return s(W(e))}function $(e){return o(W(e))}function J(e){return u(W(e))}function K(e){return l(W(e))}function Q(e){return f(W(e))}t.exports={rgb2hsl:i,rgb2hsv:s,rgb2hwb:o,rgb2cmyk:u,rgb2keyword:a,rgb2xyz:f,rgb2lab:l,rgb2lch:c,hsl2rgb:h,hsl2hsv:p,hsl2hwb:d,hsl2cmyk:v,hsl2keyword:m,hsv2rgb:y,hsv2hsl:E,hsv2hwb:S,hsv2cmyk:x,hsv2keyword:T,hwb2rgb:N,hwb2hsl:C,hwb2hsv:k,hwb2cmyk:L,hwb2keyword:A,cmyk2rgb:O,cmyk2hsl:M,cmyk2hsv:_,cmyk2hwb:D,cmyk2keyword:P,keyword2rgb:W,keyword2hsl:X,keyword2hsv:V,keyword2hwb:$,keyword2cmyk:J,keyword2lab:K,keyword2xyz:Q,xyz2rgb:H,xyz2lab:B,xyz2lch:j,lab2xyz:F,lab2rgb:q,lab2lch:I,lch2lab:R,lch2xyz:U,lch2rgb:z};var G={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Y={};for(var Z in G)Y[JSON.stringify(G[Z])]=Z},{}]},{},[1]),define("color",function(){}),define("marks/student",["knockout","marks/mark","color"],function(e,t){return function(n){var r=[],i=Color("#FDD").lighten(.03),s=Color("#89EB04").lighten(.5),o=this;o.id=n.id,o.name=n.name,o.sum=e.observable(n.sum),o.second_name=n.second_name,o.marks=$.map(n.marks,function(e){return n.lessons().every(function(t){return t.id==e.lid?(e.lesson=t,!1):!0}),e.student=o,e.m=e.m?e.m:0,new t(e)}),o.full_name=e.pureComputed(function(){return o.second_name+" "+o.name}),o.short_name=e.pureComputed(function(){return o.name&&o.name.slice(-1)!="."?o.name[0]+".":""}),o.success_factor=e.pureComputed(function(){var e=o.marks.filter(function(e){return!e.ignore_lesson()}).length,t=e*3,n=e*-2,r=.3;return o.sum()==0?r:o.sum()>0?r+o.sum()/t*(1-r):r-o.sum()/n*r}),o.color=e.pureComputed(function(){if(o.sum()!=0){var e=o.marks.length*3,t=o.marks.length*-2,n=e-t,r=1-o.sum()/n,u=s.clone();return u.mix(i,r*r*r),{backgroundColor:u.hexString(),opacity:o.sum()<0?Math.max(.1,.4+ -(r-1)):1}}return{}});var u=e.observable(!1);o.toggleActive=function(e){u(e)},o.style=e.pureComputed(function(){return u()?"active":""},u),o.modified_marks=function(){return $.grep(o.marks,function(e){return e.modified()})},o.regularStudent=e.pureComputed(function(){return o.success_factor()>=.25&&o.marks.length>0}),o.reset=function(){o.marks.every(function(e){return e.reset(),!0})}}}),define("marks/markselector",["knockout"],function(e){return function(t,n){var r=this;r.mark_selector=$(t),r.type=e.observable(),r.mark=null;var i={left:0,top:0},s=!1;r.show=function(e,t){r.mark=e;var n=$(t).offset(),o=t.clientWidth*1.1,u=t.clientHeight,a=$.map(r.mark_types(),function(e){return e.k}).indexOf(e.mark()),f=28,l=r.mark_selector.find("ul").first().width(),c=r.mark_selector.show().offset({left:n.left-l/2+o/2,top:n.top-l/2+u/2}).find("li");i.left=n.left+(o-f)/2,i.top=n.top+(u-f)/2;if(c.size()){var h=35,p=2*Math.PI/c.size();c.each(function(e,t){e!=a?$(t).offset({left:i.left+h*Math.cos(e*p),top:i.top+h*Math.sin(e*p)}):$(t).offset({left:i.left,top:i.top})})}r.mark&&r.mark.student&&r.mark.student.toggleActive(!0),s=!0,r.mark_selector.find(".mark").removeClass("lect exam test current"),r.mark_selector.find(".mark").toggleClass(e.lesson.style(),!0),r.mark_selector.find(".mark."+marksTypes[e.mark()]).toggleClass("current",!0)},r.close=function(){s=!1,r.mark_selector.hide(),r.mark&&r.mark.student&&r.mark.student.toggleActive(!1),r.mark_selector.find("li").removeAttr("style")},r.init=function(){$("body").click(function(){s&&r.close()}),$(document).keypress(function(e){e.keyCode==27&&r.close()})},r.mark_types=n,r.setMark=function(e){r.mark.mark(e.k),r.close()},r.init()}}),define("marks/qtipsettings",["pickmeup"],function(){return{content:{text:"",title:function(){return""}},position:{my:"top center"},show:{solo:!0,event:"click",effect:function(){$(this).fadeIn(120)}},hide:{fixed:!0,event:null,effect:function(){$(this).fadeOut(120)}},style:{classes:"qtip-bootstrap"},events:{show:function(e,t){var n=$("#template-lesson-edit");t.set("content.text",n);var r=this;$(r).on("click",function(e){e.stopPropagation()}),require("pickmeup")&&$(r).find(".lesson-date").pickmeup_twitter_bootstrap({hide_on_select:!0,format:"d/m/Y",hide:function(e){$(this).trigger("change")}});var i=function(){$(r).unbind("click"),$(r).qtip("hide")};$(r).find(".delete, .save").on("click",i),$(document).one("click",i)}}}}),function(e,t,n){(function(e){typeof define=="function"&&define.amd?define("qtip",["jquery"],e):jQuery&&!jQuery.fn.qtip&&e(jQuery)})(function(r){function I(e,t,n,i){this.id=n,this.target=e,this.tooltip=o,this.elements={target:e},this._id=T+"-"+n,this.timers={img:{}},this.options=t,this.plugins={},this.cache={event:{},target:r(),disabled:s,attr:i,onTooltip:s,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=s}function q(e){return e===o||r.type(e)!=="object"}function R(e){return!(r.isFunction(e)||e&&e.attr||e.length||r.type(e)==="object"&&(e.jquery||e.then))}function U(e){var t,n,u,a;return q(e)?s:(q(e.metadata)&&(e.metadata={type:e.metadata}),"content"in e&&(t=e.content,q(t)||t.jquery||t.done?t=e.content={text:n=R(t)?s:t}:n=t.text,"ajax"in t&&(u=t.ajax,a=u&&u.once!==s,delete t.ajax,t.text=function(e,t){var i=n||r(this).attr(t.options.content.attr)||"Loading...",s=r.ajax(r.extend({},u,{context:t})).then(u.success,o,u.error).then(function(e){return e&&a&&t.set("content.text",e),e},function(e,n,r){if(t.destroyed||e.status===0)return;t.set("content.text",n+": "+r)});return a?i:(t.set("content.text",i),s)}),"title"in t&&(r.isPlainObject(t.title)&&(t.button=t.title.button,t.title=t.title.text),R(t.title||s)&&(t.title=s))),"position"in e&&q(e.position)&&(e.position={my:e.position,at:e.position}),"show"in e&&q(e.show)&&(e.show=e.show.jquery?{target:e.show}:e.show===i?{ready:i}:{event:e.show}),"hide"in e&&q(e.hide)&&(e.hide=e.hide.jquery?{target:e.hide}:{event:e.hide}),"style"in e&&q(e.style)&&(e.style={classes:e.style}),r.each(x,function(){this.sanitize&&this.sanitize(e)}),e)}function z(e,t){var n=0,r,i=e,s=t.split(".");while(i=i[s[n++]])n<s.length&&(r=i);return[r||e,s.pop()]}function W(e,t){var n,r,i;for(n in this.checks)for(r in this.checks[n])if(i=(new RegExp(r,"i")).exec(e))t.push(i),(n==="builtin"||this.plugins[n])&&this.checks[n][r].apply(this.plugins[n]||this,t)}function J(e){return k.concat("").join(e?"-"+e+" ":" ")}function K(e,t){if(t>0)return setTimeout(r.proxy(e,this),t);e.call(this)}function Q(e){if(this.tooltip.hasClass(P))return;clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this.timers.show=K.call(this,function(){this.toggle(i,e)},this.options.show.delay)}function G(e){if(this.tooltip.hasClass(P)||this.destroyed)return;var t=r(e.relatedTarget),n=t.closest(L)[0]===this.tooltip[0],i=t[0]===this.options.show.target[0];clearTimeout(this.timers.show),clearTimeout(this.timers.hide);if(this!==t[0]&&this.options.position.target==="mouse"&&n||this.options.hide.fixed&&/mouse(out|leave|move)/.test(e.type)&&(n||i)){try{e.preventDefault(),e.stopImmediatePropagation()}catch(o){}return}this.timers.hide=K.call(this,function(){this.toggle(s,e)},this.options.hide.delay,this)}function Y(e){if(this.tooltip.hasClass(P)||!this.options.hide.inactive)return;clearTimeout(this.timers.inactive),this.timers.inactive=K.call(this,function(){this.hide(e)},this.options.hide.inactive)}function Z(e){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(e)}function et(e,n,i){r(t.body).delegate(e,(n.split?n:n.join("."+T+" "))+"."+T,function(){var e=b.api[r.attr(this,C)];e&&!e.disabled&&i.apply(e,arguments)})}function tt(e,n,u){var a,f,l,c,h,p=r(t.body),d=e[0]===t?p:e,v=e.metadata?e.metadata(u.metadata):o,m=u.metadata.type==="html5"&&v?v[u.metadata.name]:o,g=e.data(u.metadata.name||"qtipopts");try{g=typeof g=="string"?r.parseJSON(g):g}catch(y){}c=r.extend(i,{},b.defaults,u,typeof g=="object"?U(g):o,U(m||v)),f=c.position,c.id=n;if("boolean"==typeof c.content.text){l=e.attr(c.content.attr);if(c.content.attr===s||!l)return s;c.content.text=l}f.container.length||(f.container=p),f.target===s&&(f.target=d),c.show.target===s&&(c.show.target=d),c.show.solo===i&&(c.show.solo=f.container.closest("body")),c.hide.target===s&&(c.hide.target=d),c.position.viewport===i&&(c.position.viewport=f.container),f.container=f.container.eq(0),f.at=new E(f.at,i),f.my=new E(f.my);if(e.data(T))if(c.overwrite)e.qtip("destroy",!0);else if(c.overwrite===s)return s;return e.attr(N,n),c.suppress&&(h=e.attr("title"))&&e.removeAttr("title").attr(B,h).attr("title",""),a=new I(e,c,n,!!l),e.data(T,a),a}function ht(e){return e.charAt(0).toUpperCase()+e.slice(1)}function vt(e,t){var r=t.charAt(0).toUpperCase()+t.slice(1),i=(t+" "+dt.join(r+" ")+r).split(" "),s,o,u=0;if(pt[t])return e.css(pt[t]);while(s=i[u++])if((o=e.css(s))!==n)return pt[t]=s,o}function mt(e,t){return Math.ceil(parseFloat(vt(e,t)))}function Et(e,t){this._ns="tip",this.options=t,this.offset=t.offset,this.size=[t.width,t.height],this.init(this.qtip=e)}function Ct(e,t){this.options=t,this._ns="-modal",this.init(this.qtip=e)}function At(e,t){this._ns="ie6",this.init(this.qtip=e)}var i=!0,s=!1,o=null,u="x",a="y",f="width",l="height",c="top",h="left",p="bottom",d="right",v="center",m="flip",g="flipinvert",y="shift",b,w,E,S,x={},T="qtip",N="data-hasqtip",C="data-qtip-id",k=["ui-widget","ui-tooltip"],L="."+T,A="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),O=T+"-fixed",M=T+"-default",_=T+"-focus",D=T+"-hover",P=T+"-disabled",H="_replacedByqTip",B="oldtitle",j,F={ie:function(){for(var e=4,n=t.createElement("div");(n.innerHTML="<!--[if gt IE "+e+"]><i></i><![endif]-->")&&n.getElementsByTagName("i")[0];e+=1);return e>4?e:NaN}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||s};w=I.prototype,w._when=function(e){return r.when.apply(r,e)},w.render=function(e){if(this.rendered||this.destroyed)return this;var t=this,n=this.options,o=this.cache,u=this.elements,a=n.content.text,f=n.content.title,l=n.content.button,c=n.position,h="."+this._id+" ",p=[],d;return r.attr(this.target[0],"aria-describedby",this._id),o.posClass=this._createPosClass((this.position={my:c.my,at:c.at}).my),this.tooltip=u.tooltip=d=r("<div/>",{id:this._id,"class":[T,M,n.style.classes,o.posClass].join(" "),width:n.style.width||"",height:n.style.height||"",tracking:c.target==="mouse"&&c.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":s,"aria-describedby":this._id+"-content","aria-hidden":i}).toggleClass(P,this.disabled).attr(C,this.id).data(T,this).appendTo(c.container).append(u.content=r("<div />",{"class":T+"-content",id:this._id+"-content","aria-atomic":i})),this.rendered=-1,this.positioning=i,f&&(this._createTitle(),r.isFunction(f)||p.push(this._updateTitle(f,s))),l&&this._createButton(),r.isFunction(a)||p.push(this._updateContent(a,s)),this.rendered=i,this._setWidget(),r.each(x,function(e){var n;this.initialize==="render"&&(n=this(t))&&(t.plugins[e]=n)}),this._unassignEvents(),this._assignEvents(),this._when(p).then(function(){t._trigger("render"),t.positioning=s,!t.hiddenDuringWait&&(n.show.ready||e)&&t.toggle(i,o.event,s),t.hiddenDuringWait=s}),b.api[this.id]=this,this},w.destroy=function(e){function t(){if(this.destroyed)return;this.destroyed=i;var e=this.target,t=e.attr(B),n;this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),r.each(this.plugins,function(e){this.destroy&&this.destroy()});for(n in this.timers)clearTimeout(this.timers[n]);e.removeData(T).removeAttr(C).removeAttr(N).removeAttr("aria-describedby"),this.options.suppress&&t&&e.attr("title",t).removeAttr(B),this._unassignEvents(),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=o,delete b.api[this.id]}return this.destroyed?this.target:(e===i&&this.triggering!=="hide"||!this.rendered?t.call(this):(this.tooltip.one("tooltiphidden",r.proxy(t,this)),!this.triggering&&this.hide()),this.target)},S=w.checks={builtin:{"^id$":function(e,t,n,o){var u=n===i?b.nextid:n,a=T+"-"+u;u!==s&&u.length>0&&!r("#"+a).length?(this._id=a,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):e[t]=o},"^prerender":function(e,t,n){n&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(e,t,n){this._updateContent(n)},"^content.attr$":function(e,t,n,r){this.options.content.text===this.target.attr(r)&&this._updateContent(this.target.attr(n))},"^content.title$":function(e,t,n){if(!n)return this._removeTitle();n&&!this.elements.title&&this._createTitle(),this._updateTitle(n)},"^content.button$":function(e,t,n){this._updateButton(n)},"^content.title.(text|button)$":function(e,t,n){this.set("content."+t,n)},"^position.(my|at)$":function(e,t,n){"string"==typeof n&&(this.position[t]=e[t]=new E(n,t==="at"))},"^position.container$":function(e,t,n){this.rendered&&this.tooltip.appendTo(n)},"^show.ready$":function(e,t,n){n&&(!this.rendered&&this.render(i)||this.toggle(i))},"^style.classes$":function(e,t,n,r){this.rendered&&this.tooltip.removeClass(r).addClass(n)},"^style.(width|height)":function(e,t,n){this.rendered&&this.tooltip.css(t,n)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(e,t,n){this.rendered&&this.tooltip.toggleClass(M,!!n)},"^events.(render|show|move|hide|focus|blur)$":function(e,t,n){this.rendered&&this.tooltip[(r.isFunction(n)?"":"un")+"bind"]("tooltip"+t,n)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(!this.rendered)return;var e=this.options.position;this.tooltip.attr("tracking",e.target==="mouse"&&e.adjust.mouse),this._unassignEvents(),this._assignEvents()}}},w.get=function(e){if(this.destroyed)return this;var t=z(this.options,e.toLowerCase()),n=t[0][t[1]];return n.precedance?n.string():n};var X=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,V=/^prerender|show\.ready/i;w.set=function(e,t){if(this.destroyed)return this;var n=this.rendered,u=s,a=this.options,f=this.checks,l;return"string"==typeof e?(l=e,e={},e[l]=t):e=r.extend({},e),r.each(e,function(t,i){if(n&&V.test(t)){delete e[t];return}var s=z(a,t.toLowerCase()),o;o=s[0][s[1]],s[0][s[1]]=i&&i.nodeType?r(i):i,u=X.test(t)||u,e[t]=[s[0],s[1],i,o]}),U(a),this.positioning=i,r.each(e,r.proxy(W,this)),this.positioning=s,this.rendered&&this.tooltip[0].offsetWidth>0&&u&&this.reposition(a.position.target==="mouse"?o:this.cache.event),this},w._update=function(e,t,n){var u=this,a=this.cache;return!this.rendered||!e?s:(r.isFunction(e)&&(e=e.call(this.elements.target,a.event,this)||""),r.isFunction(e.then)?(a.waiting=i,e.then(function(e){return a.waiting=s,u._update(e,t)},o,function(e){return u._update(e,t)})):e===s||!e&&e!==""?s:(e.jquery&&e.length>0?t.empty().append(e.css({display:"block",visibility:"visible"})):t.html(e),this._waitForContent(t).then(function(e){u.rendered&&u.tooltip[0].offsetWidth>0&&u.reposition(a.event,!e.length)})))},w._waitForContent=function(e){var t=this.cache;return t.waiting=i,(r.fn.imagesLoaded?e.imagesLoaded():r.Deferred().resolve([])).done(function(){t.waiting=s}).promise()},w._updateContent=function(e,t){this._update(e,this.elements.content,t)},w._updateTitle=function(e,t){this._update(e,this.elements.title,t)===s&&this._removeTitle(s)},w._createTitle=function(){var e=this.elements,t=this._id+"-title";e.titlebar&&this._removeTitle(),e.titlebar=r("<div />",{"class":T+"-titlebar "+(this.options.style.widget?J("header"):"")}).append(e.title=r("<div />",{id:t,"class":T+"-title","aria-atomic":i})).insertBefore(e.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(e){r(this).toggleClass("ui-state-active ui-state-focus",e.type.substr(-4)==="down")}).delegate(".qtip-close","mouseover mouseout",function(e){r(this).toggleClass("ui-state-hover",e.type==="mouseover")}),this.options.content.button&&this._createButton()},w._removeTitle=function(e){var t=this.elements;t.title&&(t.titlebar.remove(),t.titlebar=t.title=t.button=o,e!==s&&this.reposition())},w._createPosClass=function(e){return T+"-pos-"+(e||this.options.position.my).abbrev()},w.reposition=function(n,o){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=i;var u=this.cache,a=this.tooltip,f=this.options.position,l=f.target,m=f.my,g=f.at,y=f.viewport,b=f.container,w=f.adjust,E=w.method.split(" "),S=a.outerWidth(s),T=a.outerHeight(s),N=0,C=0,k=a.css("position"),L={left:0,top:0},A=a[0].offsetWidth>0,O=n&&n.type==="scroll",M=r(e),_=b[0].ownerDocument,D=this.mouse,P,H,B,j;if(r.isArray(l)&&l.length===2)g={x:h,y:c},L={left:l[0],top:l[1]};else if(l==="mouse")g={x:h,y:c},(!w.mouse||this.options.hide.distance)&&u.origin&&u.origin.pageX?n=u.origin:!n||n&&(n.type==="resize"||n.type==="scroll")?n=u.event:D&&D.pageX&&(n=D),k!=="static"&&(L=b.offset()),_.body.offsetWidth!==(e.innerWidth||_.documentElement.clientWidth)&&(H=r(t.body).offset()),L={left:n.pageX-L.left+(H&&H.left||0),top:n.pageY-L.top+(H&&H.top||0)},w.mouse&&O&&D&&(L.left-=(D.scrollX||0)-M.scrollLeft(),L.top-=(D.scrollY||0)-M.scrollTop());else{l==="event"?n&&n.target&&n.type!=="scroll"&&n.type!=="resize"?u.target=r(n.target):n.target||(u.target=this.elements.target):l!=="event"&&(u.target=r(l.jquery?l:this.elements.target)),l=u.target,l=r(l).eq(0);if(l.length===0)return this;l[0]===t||l[0]===e?(N=F.iOS?e.innerWidth:l.width(),C=F.iOS?e.innerHeight:l.height(),l[0]===e&&(L={top:(y||l).scrollTop(),left:(y||l).scrollLeft()})):x.imagemap&&l.is("area")?P=x.imagemap(this,l,g,x.viewport?E:s):x.svg&&l&&l[0].ownerSVGElement?P=x.svg(this,l,g,x.viewport?E:s):(N=l.outerWidth(s),C=l.outerHeight(s),L=l.offset()),P&&(N=P.width,C=P.height,H=P.offset,L=P.position),L=this.reposition.offset(l,L,b);if(F.iOS>3.1&&F.iOS<4.1||F.iOS>=4.3&&F.iOS<4.33||!F.iOS&&k==="fixed")L.left-=M.scrollLeft(),L.top-=M.scrollTop();if(!P||P&&P.adjustable!==s)L.left+=g.x===d?N:g.x===v?N/2:0,L.top+=g.y===p?C:g.y===v?C/2:0}return L.left+=w.x+(m.x===d?-S:m.x===v?-S/2:0),L.top+=w.y+(m.y===p?-T:m.y===v?-T/2:0),x.viewport?(B=L.adjusted=x.viewport(this,L,f,N,C,S,T),H&&B.left&&(L.left+=H.left),H&&B.top&&(L.top+=H.top),B.my&&(this.position.my=B.my)):L.adjusted={left:0,top:0},u.posClass!==(j=this._createPosClass(this.position.my))&&a.removeClass(u.posClass).addClass(u.posClass=j),this._trigger("move",[L,y.elem||y],n)?(delete L.adjusted,o===s||!A||isNaN(L.left)||isNaN(L.top)||l==="mouse"||!r.isFunction(f.effect)?a.css(L):r.isFunction(f.effect)&&(f.effect.call(a,this,r.extend({},L)),a.queue(function(e){r(this).css({opacity:"",height:""}),F.ie&&this.style.removeAttribute("filter"),e()})),this.positioning=s,this):this},w.reposition.offset=function(e,n,i){function h(e,t){n.left+=t*e.scrollLeft(),n.top+=t*e.scrollTop()}if(!i[0])return n;var s=r(e[0].ownerDocument),o=!!F.ie&&t.compatMode!=="CSS1Compat",u=i[0],a,f,l,c;do(f=r.css(u,"position"))!=="static"&&(f==="fixed"?(l=u.getBoundingClientRect(),h(s,-1)):(l=r(u).position(),l.left+=parseFloat(r.css(u,"borderLeftWidth"))||0,l.top+=parseFloat(r.css(u,"borderTopWidth"))||0),n.left-=l.left+(parseFloat(r.css(u,"marginLeft"))||0),n.top-=l.top+(parseFloat(r.css(u,"marginTop"))||0),!a&&(c=r.css(u,"overflow"))!=="hidden"&&c!=="visible"&&(a=r(u)));while(u=u.offsetParent);return a&&(a[0]!==s[0]||o)&&h(a,1),n};var $=(E=w.reposition.Corner=function(e,t){e=(""+e).replace(/([A-Z])/," $1").replace(/middle/gi,v).toLowerCase(),this.x=(e.match(/left|right/i)||e.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(e.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!t;var n=e.charAt(0);this.precedance=n==="t"||n==="b"?a:u}).prototype;$.invert=function(e,t){this[e]=this[e]===h?d:this[e]===d?h:t||this[e]},$.string=function(e){var t=this.x,n=this.y,r=t!==n?t==="center"||n!=="center"&&(this.precedance===a||this.forceY)?[n,t]:[t,n]:[t];return e!==!1?r.join(" "):r},$.abbrev=function(){var e=this.string(!1);return e[0].charAt(0)+(e[1]&&e[1].charAt(0)||"")},$.clone=function(){return new E(this.string(),this.forceY)},w.toggle=function(e,n){var u=this.cache,a=this.options,f=this.tooltip;if(n){if(/over|enter/.test(n.type)&&u.event&&/out|leave/.test(u.event.type)&&a.show.target.add(n.target).length===a.show.target.length&&f.has(n.relatedTarget).length)return this;u.event=r.event.fix(n)}this.waiting&&!e&&(this.hiddenDuringWait=i);if(!this.rendered)return e?this.render(1):this;if(this.destroyed||this.disabled)return this;var l=e?"show":"hide",c=this.options[l],h=this.options[e?"hide":"show"],p=this.options.position,d=this.options.content,v=this.tooltip.css("width"),m=this.tooltip.is(":visible"),g=e||c.target.length===1,y=!n||c.target.length<2||u.target[0]===n.target,b,w,E,S,x;return(typeof e).search("boolean|number")&&(e=!m),b=!f.is(":animated")&&m===e&&y,w=b?o:!!this._trigger(l,[90]),this.destroyed?this:(w!==s&&e&&this.focus(n),!w||b?this:(r.attr(f[0],"aria-hidden",!e),e?(this.mouse&&(u.origin=r.event.fix(this.mouse)),r.isFunction(d.text)&&this._updateContent(d.text,s),r.isFunction(d.title)&&this._updateTitle(d.title,s),!j&&p.target==="mouse"&&p.adjust.mouse&&(r(t).bind("mousemove."+T,this._storeMouse),j=i),v||f.css("width",f.outerWidth(s)),this.reposition(n,arguments[2]),v||f.css("width",""),!c.solo||(typeof c.solo=="string"?r(c.solo):r(L,c.solo)).not(f).not(c.target).qtip("hide",r.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete u.origin,j&&!r(L+'[tracking="true"]:visible',c.solo).not(f).length&&(r(t).unbind("mousemove."+T),j=s),this.blur(n)),x=r.proxy(function(){e?(F.ie&&f[0].style.removeAttribute("filter"),f.css("overflow",""),"string"==typeof c.autofocus&&r(this.options.show.autofocus,f).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):f.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(e?"visible":"hidden")},this),c.effect===s||g===s?(f[l](),x()):r.isFunction(c.effect)?(f.stop(1,1),c.effect.call(f,this),f.queue("fx",function(e){x(),e()})):f.fadeTo(90,e?1:0,x),e&&c.target.trigger("qtip-"+this.id+"-inactive"),this))},w.show=function(e){return this.toggle(i,e)},w.hide=function(e){return this.toggle(s,e)},w.focus=function(e){if(!this.rendered||this.destroyed)return this;var t=r(L),n=this.tooltip,i=parseInt(n[0].style.zIndex,10),s=b.zindex+t.length,o;return n.hasClass(_)||this._trigger("focus",[s],e)&&(i!==s&&(t.each(function(){this.style.zIndex>i&&(this.style.zIndex=this.style.zIndex-1)}),t.filter("."+_).qtip("blur",e)),n.addClass(_)[0].style.zIndex=s),this},w.blur=function(e){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(_),this._trigger("blur",[this.tooltip.css("zIndex")],e),this)},w.disable=function(e){return this.destroyed?this:(e==="toggle"?e=this.rendered?!this.tooltip.hasClass(P):!this.disabled:"boolean"!=typeof e&&(e=i),this.rendered&&this.tooltip.toggleClass(P,e).attr("aria-disabled",e),this.disabled=!!e,this)},w.enable=function(){return this.disable(s)},w._createButton=function(){var e=this,t=this.elements,n=t.tooltip,i=this.options.content.button,o=typeof i=="string",u=o?i:"Close tooltip";t.button&&t.button.remove(),i.jquery?t.button=i:t.button=r("<a />",{"class":"qtip-close "+(this.options.style.widget?"":T+"-icon"),title:u,"aria-label":u}).prepend(r("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),t.button.appendTo(t.titlebar||n).attr("role","button").click(function(t){return n.hasClass(P)||e.hide(t),s})},w._updateButton=function(e){if(!this.rendered)return s;var t=this.elements.button;e?this._createButton():t.remove()},w._setWidget=function(){var e=this.options.style.widget,t=this.elements,n=t.tooltip,r=n.hasClass(P);n.removeClass(P),P=e?"ui-state-disabled":"qtip-disabled",n.toggleClass(P,r),n.toggleClass("ui-helper-reset "+J(),e).toggleClass(M,this.options.style.def&&!e),t.content&&t.content.toggleClass(J("content"),e),t.titlebar&&t.titlebar.toggleClass(J("header"),e),t.button&&t.button.toggleClass(T+"-icon",!e)},w._storeMouse=function(e){return(this.mouse=r.event.fix(e)).type="mousemove",this},w._bind=function(e,t,n,i,s){if(!e||!n||!t.length)return;var o="."+this._id+(i?"-"+i:"");return r(e).bind((t.split?t:t.join(o+" "))+o,r.proxy(n,s||this)),this},w._unbind=function(e,t){return e&&r(e).unbind("."+this._id+(t?"-"+t:"")),this},w._trigger=function(e,t,n){var i=r.Event("tooltip"+e);return i.originalEvent=n&&r.extend({},n)||this.cache.event||o,this.triggering=e,this.tooltip.trigger(i,[this].concat(t||[])),this.triggering=s,!i.isDefaultPrevented()},w._bindEvents=function(e,t,n,i,s,o){var u=n.filter(i).add(i.filter(n)),a=[];u.length&&(r.each(t,function(t,n){var i=r.inArray(n,e);i>-1&&a.push(e.splice(i,1)[0])}),a.length&&(this._bind(u,a,function(e){var t=this.rendered?this.tooltip[0].offsetWidth>0:!1;(t?o:s).call(this,e)}),n=n.not(u),i=i.not(u))),this._bind(n,e,s),this._bind(i,t,o)},w._assignInitialEvents=function(e){function f(e){if(this.disabled||this.destroyed)return s;this.cache.event=e&&r.event.fix(e),this.cache.target=e&&r(e.target),clearTimeout(this.timers.show),this.timers.show=K.call(this,function(){this.render(typeof e=="object"||t.show.ready)},t.prerender?0:t.show.delay)}var t=this.options,n=t.show.target,o=t.hide.target,u=t.show.event?r.trim(""+t.show.event).split(" "):[],a=t.hide.event?r.trim(""+t.hide.event).split(" "):[];this._bind(this.elements.target,["remove","removeqtip"],function(e){this.destroy(!0)},"destroy"),/mouse(over|enter)/i.test(t.show.event)&&!/mouse(out|leave)/i.test(t.hide.event)&&a.push("mouseleave"),this._bind(n,"mousemove",function(e){this._storeMouse(e),this.cache.onTarget=i}),this._bindEvents(u,a,n,o,f,function(){if(!this.timers)return s;clearTimeout(this.timers.show)}),(t.show.ready||t.prerender)&&f.call(this,e)},w._assignEvents=function(){var n=this,i=this.options,o=i.position,u=this.tooltip,a=i.show.target,f=i.hide.target,l=o.container,c=o.viewport,h=r(t),p=r(t.body),d=r(e),v=i.show.event?r.trim(""+i.show.event).split(" "):[],m=i.hide.event?r.trim(""+i.hide.event).split(" "):[];r.each(i.events,function(e,t){n._bind(u,e==="toggle"?["tooltipshow","tooltiphide"]:["tooltip"+e],t,null,u)}),/mouse(out|leave)/i.test(i.hide.event)&&i.hide.leave==="window"&&this._bind(h,["mouseout","blur"],function(e){!/select|option/.test(e.target.nodeName)&&!e.relatedTarget&&this.hide(e)}),i.hide.fixed?f=f.add(u.addClass(O)):/mouse(over|enter)/i.test(i.show.event)&&this._bind(f,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+i.hide.event).indexOf("unfocus")>-1&&this._bind(l.closest("html"),["mousedown","touchstart"],function(e){var t=r(e.target),n=this.rendered&&!this.tooltip.hasClass(P)&&this.tooltip[0].offsetWidth>0,i=t.parents(L).filter(this.tooltip[0]).length>0;t[0]!==this.target[0]&&t[0]!==this.tooltip[0]&&!i&&!this.target.has(t[0]).length&&n&&this.hide(e)}),"number"==typeof i.hide.inactive&&(this._bind(a,"qtip-"+this.id+"-inactive",Y,"inactive"),this._bind(f.add(u),b.inactiveEvents,Y)),this._bindEvents(v,m,a,f,Q,G),this._bind(a.add(u),"mousemove",function(e){if("number"==typeof i.hide.distance){var t=this.cache.origin||{},n=this.options.hide.distance,r=Math.abs;(r(e.pageX-t.pageX)>=n||r(e.pageY-t.pageY)>=n)&&this.hide(e)}this._storeMouse(e)}),o.target==="mouse"&&o.adjust.mouse&&(i.hide.event&&this._bind(a,["mouseenter","mouseleave"],function(e){if(!this.cache)return s;this.cache.onTarget=e.type==="mouseenter"}),this._bind(h,"mousemove",function(e){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(P)&&this.tooltip[0].offsetWidth>0&&this.reposition(e)})),(o.adjust.resize||c.length)&&this._bind(r.event.special.resize?c:d,"resize",Z),o.adjust.scroll&&this._bind(d.add(o.container),"scroll",Z)},w._unassignEvents=function(){var n=this.options,i=n.show.target,s=n.hide.target,o=r.grep([this.elements.target[0],this.rendered&&this.tooltip[0],n.position.container[0],n.position.viewport[0],n.position.container.closest("html")[0],e,t],function(e){return typeof e=="object"});i&&i.toArray&&(o=o.concat(i.toArray())),s&&s.toArray&&(o=o.concat(s.toArray())),this._unbind(o)._unbind(o,"destroy")._unbind(o,"inactive")},r(function(){et(L,["mouseenter","mouseleave"],function(e){var t=e.type==="mouseenter",n=r(e.currentTarget),i=r(e.relatedTarget||e.target),s=this.options;t?(this.focus(e),n.hasClass(O)&&!n.hasClass(P)&&clearTimeout(this.timers.hide)):s.position.target==="mouse"&&s.position.adjust.mouse&&s.hide.event&&s.show.target&&!i.closest(s.show.target[0]).length&&this.hide(e),n.toggleClass(D,t)}),et("["+C+"]",A,Y)}),b=r.fn.qtip=function(e,t,u){var a=(""+e).toLowerCase(),f=o,l=r.makeArray(arguments).slice(1),c=l[l.length-1],h=this[0]?r.data(this[0],T):o;if(!arguments.length&&h||a==="api")return h;if("string"==typeof e)return this.each(function(){var e=r.data(this,T);if(!e)return i;c&&c.timeStamp&&(e.cache.event=c);if(!t||a!=="option"&&a!=="options")e[a]&&e[a].apply(e,l);else{if(u===n&&!r.isPlainObject(t))return f=e.get(t),s;e.set(t,u)}}),f!==o?f:this;if("object"==typeof e||!arguments.length)return h=U(r.extend(i,{},e)),this.each(function(e){var t,n;n=r.isArray(h.id)?h.id[e]:h.id,n=!n||n===s||n.length<1||b.api[n]?b.nextid++:n,t=tt(r(this),n,h);if(t===s)return i;b.api[n]=t,r.each(x,function(){this.initialize==="initialize"&&this(t)}),t._assignInitialEvents(c)})},r.qtip=I,b.api={},r.each({attr:function(e,t){if(this.length){var n=this[0],i="title",s=r.data(n,"qtip");if(e===i&&s&&"object"==typeof s&&s.options.suppress)return arguments.length<2?r.attr(n,B):(s&&s.options.content.attr===i&&s.cache.attr&&s.set("content.text",t),this.attr(B,t))}return r.fn["attr"+H].apply(this,arguments)},clone:function(e){var t=r([]),n="title",i=r.fn["clone"+H].apply(this,arguments);return e||i.filter("["+B+"]").attr("title",function(){return r.attr(this,B)}).removeAttr(B),i}},function(e,t){if(!t||r.fn[e+H])return i;var n=r.fn[e+H]=r.fn[e];r.fn[e]=function(){return t.apply(this,arguments)||n.apply(this,arguments)}}),r.ui||(r["cleanData"+H]=r.cleanData,r.cleanData=function(e){for(var t=0,n;(n=r(e[t])).length;t++)if(n.attr(N))try{n.triggerHandler("removeqtip")}catch(i){}r["cleanData"+H].apply(this,arguments)}),b.version="2.2.1",b.nextid=0,b.inactiveEvents=A,b.zindex=15e3,b.defaults={prerender:s,id:s,overwrite:i,suppress:i,content:{text:i,attr:"title",title:s,button:s},position:{my:"top left",at:"bottom right",target:s,container:s,viewport:s,adjust:{x:0,y:0,mouse:i,scroll:i,resize:i,method:"flipinvert flipinvert"},effect:function(e,t,n){r(this).animate(t,{duration:200,queue:s})}},show:{target:s,event:"mouseenter",effect:i,delay:90,solo:s,ready:s,autofocus:s},hide:{target:s,event:"mouseleave",effect:i,delay:0,fixed:s,inactive:s,leave:"window",distance:s},style:{classes:"",widget:s,width:s,height:s,def:i},events:{render:o,move:o,show:o,hide:o,toggle:o,visible:o,hidden:o,focus:o,blur:o}};var nt,rt=".qtip-tip",it="margin",st="border",ot="color",ut="background-color",at="transparent",ft=" !important",lt=!!t.createElement("canvas").getContext,ct=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,pt={},dt=["Webkit","O","Moz","ms"];if(!lt)var gt=function(e,t,n){return"<qtipvml:"+e+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(t||"")+' style="behavior: url(#default#VML); '+(n||"")+'" />'};else var yt=e.devicePixelRatio||1,bt=function(){var e=t.createElement("canvas").getContext("2d");return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}(),wt=yt/bt;r.extend(Et.prototype,{init:function(e){var t,n;n=this.element=e.elements.tip=r("<div />",{"class":T+"-tip"}).prependTo(e.tooltip),lt?(t=r("<canvas />").appendTo(this.element)[0].getContext("2d"),t.lineJoin="miter",t.miterLimit=1e5,t.save()):(t=gt("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(t+t),e._bind(r("*",n).add(n),["click","mousedown"],function(e){e.stopPropagation()},this._ns)),e._bind(e.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(e){var t=this.qtip.elements.titlebar;return t&&(e.y===c||e.y===v&&this.element.position().top+this.size[1]/2+this.options.offset<t.outerHeight(i))},_parseCorner:function(e){var t=this.qtip.options.position.my;return e===s||t===s?e=s:e===i?e=new E(t.string()):e.string||(e=new E(e),e.fixed=i),e},_parseWidth:function(e,t,n){var r=this.qtip.elements,i=st+ht(t)+"Width";return(n?mt(n,i):mt(r.content,i)||mt(this._useTitle(e)&&r.titlebar||r.content,i)||mt(r.tooltip,i))||0},_parseRadius:function(e){var t=this.qtip.elements,n=st+ht(e.y)+ht(e.x)+"Radius";return F.ie<9?0:mt(this._useTitle(e)&&t.titlebar||t.content,n)||mt(t.tooltip,n)||0},_invalidColour:function(e,t,n){var r=e.css(t);return!r||n&&r===e.css(n)||ct.test(r)?s:r},_parseColours:function(e){var t=this.qtip.elements,n=this.element.css("cssText",""),i=st+ht(e[e.precedance])+ht(ot),s=this._useTitle(e)&&t.titlebar||t.content,o=this._invalidColour,u=[];return u[0]=o(n,ut)||o(s,ut)||o(t.content,ut)||o(t.tooltip,ut)||n.css(ut),u[1]=o(n,i,ot)||o(s,i,ot)||o(t.content,i,ot)||o(t.tooltip,i,ot)||t.tooltip.css(i),r("*",n).add(n).css("cssText",ut+":"+at+ft+";"+st+":0"+ft+";"),u},_calculateSize:function(e){var t=e.precedance===a,n=this.options.width,r=this.options.height,i=e.abbrev()==="c",s=(t?n:r)*(i?.5:1),o=Math.pow,u=Math.round,f,l,c,h=Math.sqrt(o(s,2)+o(r,2)),p=[this.border/s*h,this.border/r*h];return p[2]=Math.sqrt(o(p[0],2)-o(this.border,2)),p[3]=Math.sqrt(o(p[1],2)-o(this.border,2)),f=h+p[2]+p[3]+(i?0:p[0]),l=f/h,c=[u(l*n),u(l*r)],t?c:c.reverse()},_calculateTip:function(e,t,n){n=n||1,t=t||this.size;var r=t[0]*n,i=t[1]*n,s=Math.ceil(r/2),o=Math.ceil(i/2),u={br:[0,0,r,i,r,0],bl:[0,0,r,0,0,i],tr:[0,i,r,0,r,i],tl:[0,0,0,i,r,i],tc:[0,i,s,0,r,i],bc:[0,0,r,0,s,i],rc:[0,0,r,o,0,i],lc:[r,0,r,i,0,o]};return u.lt=u.br,u.rt=u.bl,u.lb=u.tr,u.rb=u.tl,u[e.abbrev()]},_drawCoords:function(e,t){e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.closePath()},create:function(){var e=this.corner=(lt||F.ie)&&this._parseCorner(this.options.corner);if(this.enabled=!!this.corner&&this.corner.abbrev()!=="c")this.qtip.cache.corner=e.clone(),this.update();return this.element.toggle(this.enabled),this.corner},update:function(t,n){if(!this.enabled)return this;var o=this.qtip.elements,m=this.element,g=m.children(),y=this.options,b=this.size,w=y.mimic,S=Math.round,x,T,N,C,k,L,A,O,M;t||(t=this.qtip.cache.corner||this.corner),w===s?w=t:(w=new E(w),w.precedance=t.precedance,w.x==="inherit"?w.x=t.x:w.y==="inherit"?w.y=t.y:w.x===w.y&&(w[t.precedance]=t[t.precedance])),T=w.precedance,t.precedance===u?this._swapDimensions():this._resetDimensions(),x=this.color=this._parseColours(t),x[1]!==at?(O=this.border=this._parseWidth(t,t[t.precedance]),y.border&&O<1&&!ct.test(x[1])&&(x[0]=x[1]),this.border=O=y.border!==i?y.border:O):this.border=O=0,A=this.size=this._calculateSize(t),m.css({width:A[0],height:A[1],lineHeight:A[1]+"px"}),t.precedance===a?L=[S(w.x===h?O:w.x===d?A[0]-b[0]-O:(A[0]-b[0])/2),S(w.y===c?A[1]-b[1]:0)]:L=[S(w.x===h?A[0]-b[0]:0),S(w.y===c?O:w.y===p?A[1]-b[1]-O:(A[1]-b[1])/2)],lt?(N=g[0].getContext("2d"),N.restore(),N.save(),N.clearRect(0,0,6e3,6e3),C=this._calculateTip(w,b,wt),k=this._calculateTip(w,this.size,wt),g.attr(f,A[0]*wt).attr(l,A[1]*wt),g.css(f,A[0]).css(l,A[1]),this._drawCoords(N,k),N.fillStyle=x[1],N.fill(),N.translate(L[0]*wt,L[1]*wt),this._drawCoords(N,C),N.fillStyle=x[0],N.fill()):(C=this._calculateTip(w),C="m"+C[0]+","+C[1]+" l"+C[2]+","+C[3]+" "+C[4]+","+C[5]+" xe",L[2]=O&&/^(r|b)/i.test(t.string())?F.ie===8?2:1:0,g.css({coordsize:A[0]+O+" "+(A[1]+O),antialias:""+(w.string().indexOf(v)>-1),left:L[0]-L[2]*Number(T===u),top:L[1]-L[2]*Number(T===a),width:A[0]+O,height:A[1]+O}).each(function(e){var t=r(this);t[t.prop?"prop":"attr"]({coordsize:A[0]+O+" "+(A[1]+O),path:C,fillcolor:x[0],filled:!!e,stroked:!e}).toggle(!!O||!!e),!e&&t.html(gt("stroke",'weight="'+O*2+'px" color="'+x[1]+'" miterlimit="1000" joinstyle="miter"'))})),e.opera&&setTimeout(function(){o.tip.css({display:"inline-block",visibility:"visible"})},1),n!==s&&this.calculate(t,A)},calculate:function(e,t){if(!this.enabled)return s;var n=this,i=this.qtip.elements,o=this.element,f=this.options.offset,l=i.tooltip.hasClass("ui-widget"),p={},d,m;return e=e||this.corner,d=e.precedance,t=t||this._calculateSize(e),m=[e.x,e.y],d===u&&m.reverse(),r.each(m,function(r,s){var o,u,l;s===v?(o=d===a?h:c,p[o]="50%",p[it+"-"+o]=-Math.round(t[d===a?0:1]/2)+f):(o=n._parseWidth(e,s,i.tooltip),u=n._parseWidth(e,s,i.content),l=n._parseRadius(e),p[s]=Math.max(-n.border,r?u:f+(l>o?l:-o)))}),p[e[d]]-=t[d===u?0:1],o.css({margin:"",top:"",bottom:"",left:"",right:""}).css(p),p},reposition:function(e,t,r,o){function N(e,t,n,r,i){e===y&&l.precedance===t&&m[r]&&l[n]!==v?l.precedance=l.precedance===u?a:u:e!==y&&m[r]&&(l[t]=l[t]===v?m[r]>0?r:i:l[t]===r?i:r)}function C(e,t,i){l[e]===v?x[it+"-"+t]=E[e]=S[it+"-"+t]-m[t]:(T=S[i]!==n?[m[t],-S[t]]:[-m[t],S[t]],(E[e]=Math.max(T[0],T[1]))>T[0]&&(r[t]-=m[t],E[t]=s),x[S[i]!==n?i:t]=E[e])}if(!this.enabled)return;var f=t.cache,l=this.corner.clone(),m=r.adjusted,g=t.options.position.adjust.method.split(" "),b=g[0],w=g[1]||g[0],E={left:s,top:s,x:0,y:0},S,x={},T;this.corner.fixed!==i&&(N(b,u,a,h,d),N(w,a,u,c,p),(l.string()!==f.corner.string()||f.cornerTop!==m.top||f.cornerLeft!==m.left)&&this.update(l,s)),S=this.calculate(l),S.right!==n&&(S.left=-S.right),S.bottom!==n&&(S.top=-S.bottom),S.user=this.offset,(E.left=b===y&&!!m.left)&&C(u,h,d),(E.top=w===y&&!!m.top)&&C(a,c,p),this.element.css(x).toggle(!(E.x&&E.y||l.x===v&&E.y||l.y===v&&E.x)),r.left-=S.left.charAt?S.user:b!==y||E.top||!E.left&&!E.top?S.left+this.border:0,r.top-=S.top.charAt?S.user:w!==y||E.left||!E.left&&!E.top?S.top+this.border:0,f.cornerLeft=m.left,f.cornerTop=m.top,f.corner=l.clone()},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),nt=x.tip=function(e){return new Et(e,e.options.style.tip)},nt.initialize="render",nt.sanitize=function(e){if(e.style&&"tip"in e.style){var t=e.style.tip;typeof t!="object"&&(t=e.style.tip={corner:t}),/string|boolean/i.test(typeof t.corner)||(t.corner=i)}},S.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(e){this.size=[e.width,e.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},r.extend(i,b.defaults,{style:{tip:{corner:i,mimic:s,width:6,height:6,border:i,offset:0}}});var St,xt,Tt="qtip-modal",Nt="."+Tt;xt=function(){function c(e){if(r.expr[":"].focusable)return r.expr[":"].focusable;var t=!isNaN(r.attr(e,"tabindex")),n=e.nodeName&&e.nodeName.toLowerCase(),i,s,o;return"area"===n?(i=e.parentNode,s=i.name,!e.href||!s||i.nodeName.toLowerCase()!=="map"?!1:(o=r("img[usemap=#"+s+"]")[0],!!o&&o.is(":visible"))):/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n?e.href||t:t}function h(e){n.length<1&&e.length?e.not("body").blur():n.first().focus()}function p(e){if(!l.is(":visible"))return;var t=r(e.target),i=u.tooltip,o=t.closest(L),f;f=o.length<1?s:parseInt(o[0].style.zIndex,10)>parseInt(i[0].style.zIndex,10),!f&&t.closest(L)[0]!==i[0]&&h(t),a=e.target===n[n.length-1]}var e=this,n={},u,a,f,l;r.extend(e,{init:function(){return l=e.elem=r("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return s}}).hide(),r(t.body).bind("focusin"+Nt,p),r(t).bind("keydown"+Nt,function(e){u&&u.options.show.modal.escape&&e.keyCode===27&&u.hide(e)}),l.bind("click"+Nt,function(e){u&&u.options.show.modal.blur&&u.hide(e)}),e},update:function(e){u=e,e.options.show.modal.stealfocus!==s?n=e.tooltip.find("*").filter(function(){return c(this)}):n=[]},toggle:function(n,a,c){var p=r(t.body),d=n.tooltip,v=n.options.show.modal,m=v.effect,g=a?"show":"hide",y=l.is(":visible"),b=r(Nt).filter(":visible:not(:animated)").not(d),w;return e.update(n),a&&v.stealfocus!==s&&h(r(":focus")),l.toggleClass("blurs",v.blur),a&&l.appendTo(t.body),l.is(":animated")&&y===a&&f!==s||!a&&b.length?e:(l.stop(i,s),r.isFunction(m)?m.call(l,a):m===s?l[g]():l.fadeTo(parseInt(c,10)||90,a?1:0,function(){a||l.hide()}),a||l.queue(function(e){l.css({left:"",top:""}),r(Nt).length||l.detach(),e()}),f=a,u.destroyed&&(u=o),e)}}),e.init()},xt=new xt,r.extend(Ct.prototype,{init:function(e){var t=e.tooltip;if(!this.options.on)return this;e.elements.overlay=xt.elem,t.addClass(Tt).css("z-index",b.modal_zindex+r(Nt).length),e._bind(t,["tooltipshow","tooltiphide"],function(e,n,i){var s=e.originalEvent;if(e.target===t[0])if(s&&e.type==="tooltiphide"&&/mouse(leave|enter)/.test(s.type)&&r(s.relatedTarget).closest(xt.elem[0]).length)try{e.preventDefault()}catch(o){}else(!s||s&&s.type!=="tooltipsolo")&&this.toggle(e,e.type==="tooltipshow",i)},this._ns,this),e._bind(t,"tooltipfocus",function(e,n){if(e.isDefaultPrevented()||e.target!==t[0])return;var i=r(Nt),s=b.modal_zindex+i.length,o=parseInt(t[0].style.zIndex,10);xt.elem[0].style.zIndex=s-1,i.each(function(){this.style.zIndex>o&&(this.style.zIndex-=1)}),i.filter("."+_).qtip("blur",e.originalEvent),t.addClass(_)[0].style.zIndex=s,xt.update(n);try{e.preventDefault()}catch(u){}},this._ns,this),e._bind(t,"tooltiphide",function(e){e.target===t[0]&&r(Nt).filter(":visible").not(t).last().qtip("focus",e)},this._ns,this)},toggle:function(e,t,n){if(e&&e.isDefaultPrevented())return this;xt.toggle(this.qtip,!!t,n)},destroy:function(){this.qtip.tooltip.removeClass(Tt),this.qtip._unbind(this.qtip.tooltip,this._ns),xt.toggle(this.qtip,s),delete this.qtip.elements.overlay}}),St=x.modal=function(e){return new Ct(e,e.options.show.modal)},St.sanitize=function(e){e.show&&(typeof e.show.modal!="object"?e.show.modal={on:!!e.show.modal}:typeof e.show.modal.on=="undefined"&&(e.show.modal.on=i))},b.modal_zindex=b.zindex-200,St.initialize="render",S.modal={"^show.modal.(on|blur)$":function(){this.destroy(),this.init(),this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}},r.extend(i,b.defaults,{show:{modal:{on:s,effect:i,blur:i,stealfocus:i,escape:i}}}),x.viewport=function(n,r,i,o,m,b,w){function R(e,t,n,i,s,o,u,a,l){var c=r[s],h=x[e],p=T[e],d=n===y,m=h===s?l:h===o?-l:-l/2,b=p===s?a:p===o?-a:-a/2,w=I[s]+q[s]-(B?0:H[s]),E=w-c,S=c+l-(u===f?j:F)-w,N=m-(x.precedance===e||h===x[t]?b:0)-(p===v?a/2:0);return d?(N=(h===s?1:-1)*m,r[s]+=E>0?E:S>0?-S:0,r[s]=Math.max(-H[s]+q[s],c-N,Math.min(Math.max(-H[s]+q[s]+(u===f?j:F),c+N),r[s],h==="center"?c-m:1e9))):(i*=n===g?2:0,E>0&&(h!==s||S>0)?(r[s]-=N+i,P.invert(e,s)):S>0&&(h!==o||E>0)&&(r[s]-=(h===v?-N:N)+i,P.invert(e,o)),r[s]<I&&-r[s]>S&&(r[s]=c,P=x.clone())),r[s]-c}var E=i.target,S=n.elements.tooltip,x=i.my,T=i.at,N=i.adjust,C=N.method.split(" "),k=C[0],L=C[1]||C[0],A=i.viewport,O=i.container,M=n.cache,_={left:0,top:0},D,P,H,B,j,F,I,q;if(!A.jquery||E[0]===e||E[0]===t.body||N.method==="none")return _;H=O.offset()||_,B=O.css("position")==="static",D=S.css("position")==="fixed",j=A[0]===e?A.width():A.outerWidth(s),F=A[0]===e?A.height():A.outerHeight(s),I={left:D?0:A.scrollLeft(),top:D?0:A.scrollTop()},q=A.offset()||_;if(k!=="shift"||L!=="shift")P=x.clone();return _={left:k!=="none"?R(u,a,k,N.x,h,d,f,o,b):0,top:L!=="none"?R(a,u,L,N.y,c,p,l,m,w):0,my:P},_},x.polys={polygon:function(e,t){var n={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:s},r=0,i,o=[],u=1,a=1,f=0,l=0,m,g;r=e.length;while(r--)i=[parseInt(e[--r],10),parseInt(e[r+1],10)],i[0]>n.position.right&&(n.position.right=i[0]),i[0]<n.position.left&&(n.position.left=i[0]),i[1]>n.position.bottom&&(n.position.bottom=i[1]),i[1]<n.position.top&&(n.position.top=i[1]),o.push(i);m=n.width=Math.abs(n.position.right-n.position.left),g=n.height=Math.abs(n.position.bottom-n.position.top);if(t.abbrev()==="c")n.position={left:n.position.left+n.width/2,top:n.position.top+n.height/2};else{while(m>0&&g>0&&u>0&&a>0){m=Math.floor(m/2),g=Math.floor(g/2),t.x===h?u=m:t.x===d?u=n.width-m:u+=Math.floor(m/2),t.y===c?a=g:t.y===p?a=n.height-g:a+=Math.floor(g/2),r=o.length;while(r--){if(o.length<2)break;f=o[r][0]-n.position.left,l=o[r][1]-n.position.top,(t.x===h&&f>=u||t.x===d&&f<=u||t.x===v&&(f<u||f>n.width-u)||t.y===c&&l>=a||t.y===p&&l<=a||t.y===v&&(l<a||l>n.height-a))&&o.splice(r,1)}}n.position={left:o[0][0],top:o[0][1]}}return n},rect:function(e,t,n,r){return{width:Math.abs(n-e),height:Math.abs(r-t),position:{left:Math.min(e,n),top:Math.min(t,r)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(e,t,n,r,i){var o=x.polys._angles[i.abbrev()],u=o===0?0:n*Math.cos(o*Math.PI),a=r*Math.sin(o*Math.PI);return{width:n*2-Math.abs(u),height:r*2-Math.abs(a),position:{left:e+u,top:t+a},adjustable:s}},circle:function(e,t,n,r){return x.polys.ellipse(e,t,n,n,r)}},x.svg=function(e,n,i){var o=r(t),u=n[0],a=r(u.ownerSVGElement),f=u.ownerDocument,l=(parseInt(n.css("stroke-width"),10)||0)/2,c,h,p,d,v,m,g,y,b,w,E;while(!u.getBBox)u=u.parentNode;if(!u.getBBox||!u.parentNode)return s;switch(u.nodeName){case"ellipse":case"circle":b=x.polys.ellipse(u.cx.baseVal.value,u.cy.baseVal.value,(u.rx||u.r).baseVal.value+l,(u.ry||u.r).baseVal.value+l,i);break;case"line":case"polygon":case"polyline":y=u.points||[{x:u.x1.baseVal.value,y:u.y1.baseVal.value},{x:u.x2.baseVal.value,y:u.y2.baseVal.value}];for(b=[],g=-1,v=y.numberOfItems||y.length;++g<v;)m=y.getItem?y.getItem(g):y[g],b.push.apply(b,[m.x,m.y]);b=x.polys.polygon(b,i);break;default:b=u.getBBox(),b={width:b.width,height:b.height,position:{left:b.x,top:b.y}}}return w=b.position,a=a[0],a.createSVGPoint&&(h=u.getScreenCTM(),y=a.createSVGPoint(),y.x=w.left,y.y=w.top,p=y.matrixTransform(h),w.left=p.x,w.top=p.y),f!==t&&e.position.target!=="mouse"&&(c=r((f.defaultView||f.parentWindow).frameElement).offset(),c&&(w.left+=c.left,w.top+=c.top)),f=r(f),w.left+=f.scrollLeft(),w.top+=f.scrollTop(),b},x.imagemap=function(e,t,n,i){t.jquery||(t=r(t));var o=(t.attr("shape")||"rect").toLowerCase().replace("poly","polygon"),u=r('img[usemap="#'+t.parent("map").attr("name")+'"]'),a=r.trim(t.attr("coords")),f=a.replace(/,$/,"").split(","),l,c,h,p,d,v;if(!u.length)return s;if(o==="polygon")d=x.polys.polygon(f,n);else{if(!x.polys[o])return s;for(h=-1,v=f.length,c=[];++h<v;)c.push(parseInt(f[h],10));d=x.polys[o].apply(this,c.concat(n))}return l=u.offset(),l.left+=Math.ceil((u.outerWidth(s)-u.width())/2),l.top+=Math.ceil((u.outerHeight(s)-u.height())/2),d.position.left+=l.left,d.position.top+=l.top,d};var kt,Lt='<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>';r.extend(At.prototype,{_scroll:function(){var t=this.qtip.elements.overlay;t&&(t[0].style.top=r(e).scrollTop()+"px")},init:function(n){var i=n.tooltip,s;r("select, object").length<1&&(this.bgiframe=n.elements.bgiframe=r(Lt).appendTo(i),n._bind(i,"tooltipmove",this.adjustBGIFrame,this._ns,this)),this.redrawContainer=r("<div/>",{id:T+"-rcontainer"}).appendTo(t.body),n.elements.overlay&&n.elements.overlay.addClass("qtipmodal-ie6fix")&&(n._bind(e,["scroll","resize"],this._scroll,this._ns,this),n._bind(i,["tooltipshow"],this._scroll,this._ns,this)),this.redraw()},adjustBGIFrame:function(){var e=this.qtip.tooltip,t={height:e.outerHeight(s),width:e.outerWidth(s)},n=this.qtip.plugins.tip,r=this.qtip.elements.tip,i,o;o=parseInt(e.css("borderLeftWidth"),10)||0,o={left:-o,top:-o},n&&r&&(i=n.corner.precedance==="x"?[f,h]:[l,c],o[i[1]]-=r[i[0]]()),this.bgiframe.css(o).css(t)},redraw:function(){if(this.qtip.rendered<1||this.drawing)return this;var e=this.qtip.tooltip,t=this.qtip.options.style,n=this.qtip.options.position.container,r,i,s,o;return this.qtip.drawing=1,t.height&&e.css(l,t.height),t.width?e.css(f,t.width):(e.css(f,"").appendTo(this.redrawContainer),i=e.width(),i%2<1&&(i+=1),s=e.css("maxWidth")||"",o=e.css("minWidth")||"",r=(s+o).indexOf("%")>-1?n.width()/100:0,s=(s.indexOf("%")>-1?r:1)*parseInt(s,10)||i,o=(o.indexOf("%")>-1?r:1)*parseInt(o,10)||0,i=s+o?Math.min(Math.max(i,o),s):i,e.css(f,Math.round(i)).appendTo(n)),this.drawing=0,this},destroy:function(){this.bgiframe&&this.bgiframe.remove(),this.qtip._unbind([e,this.qtip.tooltip],this._ns)}}),kt=x.ie6=function(e){return F.ie===6?new At(e):s},kt.initialize="render",S.ie6={"^content|style$":function(){this.redraw()}}})}(window,document),define("marks/markstable",["knockout","urls","cookies","helpers","marks/lesson","marks/mark","marks/student","marks/markselector","marks/qtipsettings","jquery","qtip"],function(e,t,n,r,i,s,o,u,a){return function(s){var a=this,f={marks_editor:"#marks-editor",marks_selector:"#mark-selector",scroll_container:".m-table-container"};a.selectors=f,a.students=e.observableArray(),a.students_control=e.observableArray(),a.student=e.observable(),a.students_cache={},a.lessons=e.observableArray(),a.lesson_types=e.observableArray(),a.lesson=e.observable(),a.labs=e.observableArray(),a.tasksProgress=e.observableArray(),a.group_id=0,a.discipline_id=0,a.firstLoadingAfterParametersChanged=e.observable(!0),a.isStudentsLoading=e.observable(!0),a.isStudentsAboutToLoading=e.observable(!1),a.showLoading=e.pureComputed(function(){return a.isStudentsLoading()||a.students&&a.students().length==0}),a.showPanel=e.pureComputed(function(){return(a.students().length||a.isStudentsLoading())&&!a.firstLoadingAfterParametersChanged()}),a.setParams=function(e,t){a.group_id=e,e==null&&a.isStudentsLoading(!1),a.discipline_id=t,a.loadStudents()},a.setLabs=function(e,t){a.labs=t.labs},a.$markseditor=$(f.marks_editor),a.$markseditor.collapse({toggle:!1}),a.$markseditor.on({mouseenter:function(){var e=$(this).index();$(this).addClass("hover"),$(".m-table>tbody, .s-table>tbody").each(function(t,n){$($(n).find(">.t-row")[e]).addClass("hover")})},mouseleave:function(){$(this).removeClass("hover");var e=$(this).index();$(".m-table>tbody, .s-table>tbody").each(function(t,n){$($(n).find(">.t-row")[e]).removeClass("hover")})}},".m-table>tbody>.t-row,.s-table>tbody>.t-row"),a.marksTypes=e.observableArray(),a.hideBadStudents=e.observable(!0),a.markSelector=new u(f.marks_selector,a.marksTypes),a.processData=function(e){function s(){r==-1&&(a.students.removeAll(),setTimeout(s,10),++r);if(r<e.students.length){var t=e.students[r];return++r,t.lessons=a.lessons,a.students.push(new o(t)),setTimeout(s,10),!0}a.sortMethod(a.sortMethods[$.cookie(n.sorting)]),$.cookie(n.group_id,a.group_id,{expires:n.expires}),a.resetMarksInterface(),a.isStudentsLoading(!1),a.isStudentsAboutToLoading(!1),a.firstLoadingAfterParametersChanged(!1);var i=$.cookie(n.keep_mark_table_open);return i=="false"?a.$markseditor.collapse("hide"):a.$markseditor.collapse("show"),a.students_cache[a.discipline_id]||(a.students_cache[a.discipline_id]={}),a.students_cache[a.discipline_id][a.group_id]=e,!1}a.lesson_types(e.lesson_types),marksTypes={},a.marksTypes(e.mark_types),e.mark_types.every(function(e){return marksTypes[e.k]=e.v,!marksTypes.max<parseInt(e.k)&&(marksTypes.max=parseInt(e.k)),!marksTypes.min>parseInt(e.k)&&(marksTypes.min=parseInt(e.k)),!0});var t=$.map(e.lessons,function(e){return new i(e,a)});a.lessons(t);var r=-1;e.students.length>0&&s()},a.loadStudents=function(e){if(a.isStudentsAboutToLoading())return;a.isStudentsAboutToLoading(!0);var n=function(){if(!a.group_id){a.isStudentsAboutToLoading(!1),a.isStudentsLoading(!1);return}a.isStudentsLoading(!0),a.hideBadStudents(!0),!e&&a.students_cache[a.discipline_id]&&a.students_cache[a.discipline_id][a.group_id]?a.processData(a.students_cache[a.discipline_id][a.group_id]):setTimeout(function(){$.get(t.url.students,{group_id:a.group_id,discipline_id:a.discipline_id}).done(function(e){a.processData(e)}).always(function(){}).fail(function(){a.resetMarksInterface()})},60)};a.$markseditor.hasClass("in")?(a.$markseditor.one("hidden.bs.collapse",n),a.$markseditor.collapse("hide","fast")):n()},a.loadStudentsControl=function(){window.location=t.url.students_control+"?"+$.param([{name:"year",value:a.year()},{name:"discipline_id",value:a.discipline_id},{name:"k",value:.5}])},a.resetMarksInterface=function(){$('thead [data-toggle="tooltip"]').tooltip({placement:"bottom"}),$('tfoot [data-toggle="tooltip"]').tooltip({placement:"top"});var e=$(f.scroll_container);e.size()&&$.cookie("lastScroll")&&(e[0].scrollLeft=$.cookie("lastScroll"))},a.sortByStudentsMark=function(e,t){return e.sum()==t.sum()?0:e.sum()<t.sum()?1:-1},a.sortByStudentsMark.title=" ",a.sortByStudentsName=function(e,t){var n=e.sum()>=0?1:-1,r=t.sum()>=0?1:-1;return e.second_name<t.second_name?n==r?-1:n<r?1:-1:e.second_name>t.second_name?n==r?1:n<r?1:-1:0},a.sortByStudentsName.title=" ",a.sortMethods={},a.sortMethods[a.sortByStudentsMark.title]=a.sortByStudentsMark,a.sortMethods[a.sortByStudentsName.title]=a.sortByStudentsName,a.sortMethods["undefined"]=a.sortByStudentsName,a.sortMethod=e.observable(),a.sortMethod.subscribe(function(){a.sortMethod()&&a.students.sort(a.sortMethod())}),a.toggleStudentsSorting=function(){a.sortMethod(a.sortMethod()==a.sortByStudentsMark?a.sortByStudentsName:a.sortByStudentsMark),$.cookie(n.sorting,a.sortMethod().title,{expires:n.expires})},a.showPercents=e.observable($.cookie(n.score_method)!=="false"),a.scoreMethod=e.pureComputed(function(){return a.showPercents()?" ":" "},a.showPercents),a.toggleScorePercents=function(){a.showPercents(!a.showPercents()),$.cookie(n.score_method,a.showPercents(),{expires:n.expires})},a.toggleBadStudentHiding=function(){a.hideBadStudents(!a.hideBadStudents());var e=$(f.marks_editor).find(".collapsed"),t=e.find(".t-cell"),n={duration:300,easing:"swing"};a.hideBadStudents()?(t.slideUp(n),e.fadeOut(n)):(t.slideDown(n),e.fadeIn(n))};var l=$("#lesson-editor"),c=!1;$(window).on("click",function(e){if(c)return;var t=$(e.target);e.target!=l[0]&&!t.hasClass("lesson-edit")&&!t.parents().filter("#lesson-editor").length&&(l.fadeOut("fast"),c=!0)}),a.lessonHover=function(e,t){c=!0;var n=$(t.currentTarget);n.parent("td").length&&(n=$(n.parent("td")[0]));var r=n.offset();a.lesson(e),l.fadeIn("fast").offset({top:r.top+n.height()-2,left:r.left-l.width()/2}),setTimeout(function(){var e=$(".icp").iconpicker();e.on("iconpickerUpdated",function(){$(this).trigger("change")}),l.find(".lesson-date").pickmeup({hide_on_select:!0,format:"d/m/Y",hide:function(e){$(this).trigger("change")}}),c=!1},60)},a.addLesson=function(){$.post(t.url.lesson_add,r.csrfize({discipline_id:a.discipline_id,group_id:a.group_id})).done(function(){a.loadStudents(!0)}).fail(function(){r.showFail()})},a.removeLesson=function(e){e.remove(function(){a.loadStudents(!0)})},a.saveLesson=function(e){$.post(t.url.lesson_save,r.csrfize({lesson_id:e.id,lesson_type:e.lesson_type(),date:e.isodate(),multiplier:e.multiplier(),description_raw:e.description_raw(),score_ignore:e.score_ignore(),icon_id:e.icon_id()==null?-1:e.icon_id(),fa_icon:e.fa_icon})).done(function(t){e.isodate()!=e.isodate_old?a.loadStudents(!0):(e.description(t.description),e.description_raw(t.description_raw)),r.showSuccess()}).fail(function(){r.showFail()})},a.saveMarks=function(){var e=[];for(var n=0;n<a.students().length;++n){var i=a.students()[n].modified_marks();i.every(function(t){return e.push({lesson_id:t.lesson_id,student_id:t.student_id,mark:t.mark()}),!0})}if(a.labs())for(var n=0,s=a.labs().length,o=a.labs();n<s;++n)o[n].saveTaskMarks();r.post(t.url.marks_save,{marks:JSON.stringify(e)},function(){for(var e=0;e<a.students().length;++e)a.students()[e].reset();a.loadStudents()})},a.toExcel=function(e,n){window.location=t.url.to_excel+"?"+$.param([{name:"group_id",value:a.group_id},{name:"discipline_id",value:a.discipline_id}])},a.resetCache=function(e,n){$.get(t.url.reset_cache).done(function(){window.location.reload()})},a.clickMark=function(e,t){if(s.containerMoved)return!1;setTimeout(function(){a.markSelector.show(e,t.target)},10)},a.clickTask=function(e,t,n){},a.increase=function(e){e.increase()},a.decrease=function(e){e.decrease()},a.is_active=e.pureComputed(function(){return a.students().length>0})}}),define("labs/task",["knockout","urls","helpers"],function(e,t,n){return function(r){function s(e){var t=[];return i.students().every(function(e){return t.push(e.id),!0}),t}var i=this;i.id=r.id,i.complexity=e.observable(r.complexity),i.description=e.observable(r.description),i.order=e.observable(r.order),i.students=e.observableArray(r.students),i._complex_choices=r.complex_choices,i.lab=r.lab,i.students_ids=e.pureComputed(function(){return s(i.students)}),i.old_students=s(r.students),i.style=e.pureComputed(function(){var e="";e+=i._complex_choices[i.complexity()];switch(i.students().length){case 0:break;case 1:e+=" selected";break;case 2:e+=" selected2";break;default:e+=" selected3"}return e}),i.complex_choices=e.pureComputed(function(){var e=[];return Object.keys(i._complex_choices).every(function(t){return e.push({value:t,"class":i._complex_choices[t]}),!0}),e}),i.changed=e.pureComputed(function(){return i.complexity()!=r.complexity||i.description()!=r.description||!i.students_ids().equals(i.old_students)}),i.setComplex=function(e){i.complexity(e.value)},i.reset=function(){r.complexity=i.complexity(),r.description=i.description(),i.old_students=i.students_ids(),i.complexity.notifySubscribers()},i.save=function(){console.log("saved"),n.post(t.url.task_save,n.csrfize({id:i.id,complexity:i.complexity(),description:i.description(),students:JSON.stringify(i.students_ids())}),i.reset)},i.remove=function(e,r){$.prompt(' "'+i.description()+'"?',{persistent:!1,buttons:{"":!0," ":!1},submit:function(s,o){o&&n.post(t.url.task_delete,{id:i.id},e,r)}})}}}),define("labs/marktask",["knockout","urls"],function(e,t){return function(t){var n=this,r=t;r.done=r.done===undefined?!1:r.done,n.id=r.id===undefined?-1:r.id,n.student=r.student,n.task=r.task,n.group=r.group,n.created=new Date(r.created),n.done=e.observable(r.done),n.lab=e.observable(r.lab),n.task_inst=e.observable(r.task_inst),n.changed=e.pureComputed(function(){return r.done!=n.done()}),n.post_data=function(){return{id:n.id,student:n.student,task:n.task,done:n.done()}},n.css=e.pureComputed(function(){var e=0;n.lab&&(e=~~((n.created-n.lab().leftMarksDate)/864e5));var t={done:n.done(),changed:n.changed(),fast:e<7,"fast-normal":7<=e&&e<14,normal:14<=e&&e<21,"normal-slow":21<=e&&e<28,slow:28<=e&&e<35,"slow-veryslow":35<=e&&e<42,veryslow:42<=e};return t}),n.reset=function(){r.done=n.done()},n.toggle=function(){n.done(!n.done())}}}),define("labs/lab",["knockout","urls","helpers","labs/task","labs/marktask"],function(e,t,n,r,i){return function(s){function u(){var e=1;s.tasks.every(function(t){return t.complex_choices=s.complex_choices,t.order=e++,t.lab=o,o.tasks.push(new r(t)),!0}),o.setMarks(s.marks)}var o=this;o.id=s.id,o.complex_choices=s.complex_choices,o.title=e.observable(s.title),o.description=e.observable(s.description),o.discipline=e.observable(s.discipline),o.order=e.observable(s.order),o.tasks=e.observableArray(),o.visible=e.observable(s.visible),o.regular=e.observable(s.regular),o.columns_count=e.observable(s.columns_count),o.marks={},o.leftMarksDate="",o.rightMarksDate="",o.diffMarksDate="",o.show=e.observable(!1),o.columns_with_tasks=e.pureComputed(function(){var e=[],t=0,n={items:[]},r=Math.ceil(o.tasks().length/o.columns_count());for(var i=0;i<o.tasks().length;++i){var s=~~(i/r);t!=s&&(t=s,e.push(n),n={items:[]}),n.items.push(o.tasks()[i])}return e.push(n),e}),o.column_style=e.pureComputed(function(){return"col-md-"+~~(12/o.columns_count())}),o.hasTaskMarksForStudent=function(e){var t=o.marks[e.id];for(var n in t)if(t[n].done())return!0;return!1},o.setMarks=function(e){o.marks={},e.length&&e[0].created&&(o.leftMarksDate=new Date(e[0].created),o.rightMarksDate=new Date(e[0].created)),e.every(function(e){if(e.created){var t=new Date(e.created);t<o.leftMarksDate&&(o.leftMarksDate=t),t>o.rightMarksDate&&(o.rightMarksDate=t)}return!0}),o.diffMarksDate=o.rightMarksDate-o.leftMarksDate,e.every(function(e){var t=o.marks[e.student];return t||(o.marks[e.student]={},t=o.marks[e.student]),e.student_inst=e.student,e.task_inst=e.task,e.lab=o,t[e.task]=new i(e),!0})},o.mark=function(e,t){return o.marks[t.id]||(o.marks[t.id]={}),o.marks[t.id][e.id]||(o.marks[t.id][e.id]=new i({student:t.id,task:e.id,student_inst:t,task_inst:t,lab:o})),o.marks[t.id][e.id]},o.toggleTaskMark=function(e){var t={};t[e.student]={},t[e.student][e.task]=e,o.marks[e.student]===undefined&&(o.marks[e.student]={}),t=o.marks[e.student],t[e.task]===undefined&&(t[e.task]={}),t[e.task]=e,e.toggle()},o.remove=function(e,r){$.prompt(' "'+o.title()+'"?',{persistent:!1,buttons:{"":!0," ":!1},submit:function(i,s){s&&n.post(t.url.lab_delete,{id:o.id},e,r)}})},o.changed=e.pureComputed(function(){return s.title!=o.title()||s.description!=o.description()||s.columns_count!=o.columns_count()||s.discipline!=o.discipline()}),o.style=e.pureComputed(function(){return"columns"+o.columns_count()}),o.order_changed=e.pureComputed(function(){return s.order!=o.order()}),o.save=function(e,r){r&&r.stopImmediatePropagation();var i=[];for(var s=0,u=o.tasks().length;s<u;++s){var a=o.tasks()[s];i.push(a.id)}n.post(t.url.lab_save,{id:o.id,title:o.title(),description:o.description(),discipline:o.discipline(),visible:o.visible(),regular:o.regular(),columns_count:o.columns_count(),order_array:JSON.stringify(i)},o.reset)},o.saveTaskMarks=function(e,r){var i=[];for(var s in o.marks)for(var u in o.marks[s]){var a=o.marks[s][u];a.changed()&&(i.push(a.post_data()),a.reset())}i.length&&n.post(t.url.lab_save_taskmarks,{marks:JSON.stringify(i)},function(){})},o.reset=function(){s.title=o.title(),s.description=o.description(),s.discipline=o.discipline(),s.order=o.order(),s.visible=o.visible(),s.regular=o.regular(),s.columns_count=o.columns_count(),o.title.notifySubscribers(),o.order.notifySubscribers()},o.reset_order=function(){s.order=o.order(),o.order.notifySubscribers()},o.addTask=function(e,i){i&&i.stopImmediatePropagation(),$.prompt({state:{title:"",html:'<textarea class="form-control" name="description" placeholder="" value="..."></textarea>',buttons:{"":!0,"":!1},submit:function(e,i,s,u){i&&n.post(t.url.task_add,{lab_id:o.id,description:u.description},function(e){e.complex_choices=o.complex_choices,o.tasks.push(new r(e)),o.sort()})}}})},o.removeTask=function(e,t){t&&t.stopImmediatePropagation(),e.remove(function(){o.tasks.remove(e)})},o.sort=function(){o.tasks.sort(function(e,t){return e.complexity()==t.complexity()?e.order()==t.order()?0:e.order()<t.order()?-1:1:e.complexity()<t.complexity()?-1:1})},o.toggle=function(e,t){t&&t.stopImmediatePropagation(),o.visible(!o.visible()),o.save(e,t)},o.toggle_regular=function(e,t){t&&t.stopImmediatePropagation(),o.regular(!o.regular()),o.save(e,t)},o.moveTaskUp=function(e,t){t&&t.stopImmediatePropagation();var n=o.tasks.indexOf(e);if(n==0)return;var r=o.tasks()[n-1];if(e.complexity()!=r.complexity())return;var i=e.order();e.order(r.order()),r.order(i),o.sort()},o.moveTaskDown=function(e,t){t&&t.stopImmediatePropagation();var n=o.tasks.indexOf(e);if(n==o.tasks().length-1)return;var r=o.tasks()[n+1];if(e.complexity()!=r.complexity())return;var i=e.order();e.order(r.order()),r.order(i),o.sort()},u()}}),define("labs/labstable",["knockout","urls","helpers","labs/lab","labs/marktask"],function(e,t,n,r,i){return function(){var s=this;s.discipline_id=0,s.complex_choices={},s.labs=e.observableArray([]);var o=null;s.labsLoading=e.observable(!1),s.onLabsLoadingComplete=null,s.setParams=function(e){s.discipline_id!=e&&(s.discipline_id=e,s.loadLabs())},s.hasLabsForStudent=function(t){return e.pureComputed(function(){return s.labs().some(function(e){return e.hasTaskMarksForStudent(t)})})};var u=!1,a=6e4;s.updateLabs=function(){if(t.url.logged||u)return;u=!0,$.get(t.url.labs,{discipline_id:s.discipline_id}).done(function(e){var t=0,n,r;e.labs.every(function(r){var o=null;return e.labs.forEach(function(e){for(n=0,l=s.labs().length;n<l;++n){var t=s.labs()[n];if(t.id==e.id){o=t;break}}if(o)for(n=0;n<e.marks.length;++n){var r=e.marks[n],u=o.marks[r.student];u?(u=u[r.task],u?u.done()!=r.done&&u.toggle():o.toggleTaskMark(new i({student:r.student,task:r.task,lab:s}))):s.toggleTaskMark(o,u)}}),r.complex_choices=e.complex_choices,r.order=t++,!0})}).fail(n.showFail).always(function(){u=!1,setTimeout(s.updateLabs,a)})},s.loadLabs=function(e){s.labs.removeAll(),s.labsLoading(!0),$.get(t.url.labs,{discipline_id:s.discipline_id}).done(function(e){s.complex_choices=e.complex_choices;var t=0;e.labs.every(function(n){return n.complex_choices=e.complex_choices,n.order=t++,s.labs.push(new r(n)),!0}),s.labsLoading(!1),s.labs().length&&setTimeout(s.updateLabs,a);var n=100,i=300;s.labs().forEach(function(e){i+=n,setTimeout(function(){e.show(!0)},i)}),s.onLabsLoadingComplete&&setTimeout(function(){s.onLabsLoadingComplete(e,s)},100)}).fail(n.showFail)},s.addLab=function(e,r){r.stopImmediatePropagation(),$.prompt({state:{title:"",html:'<input class="form-control" type="text" name="title" placeholder="" value=" ">',buttons:{"":!0,"":!1},submit:function(e,r,i,o){r&&n.post(t.url.lab_add,{discipline_id:s.discipline_id,title:o.title},s.loadLabs)}}})},s.saveAll=function(e,r){r.stopImmediatePropagation();var i=[];s.sort(),s.labs().every(function(e){return i.push(e.id),e.reset_order(),!0}),n.post(t.url.lab_save_order,{order_array:JSON.stringify(i),id:s.discipline_id},function(){s.labs.notifySubscribers(),s.labs().every(function(e){return e.changed()&&e.save(),!0})})},s.removeLab=function(e,t){t.stopImmediatePropagation(),e.remove(function(){s.labs.remove(e)})},s.changed=e.pureComputed(function(){return s.labs().some(function(e){return e.order_changed()})}),s.is_active=e.pureComputed(function(){return s.labs().length>0}),s.sort=function(){s.labs.sort(function(e,t){return e.order()==t.order()?0:e.order()<t.order()?-1:1})},s.moveLabUp=function(e,t){t&&t.stopImmediatePropagation();var n=s.labs.indexOf(e);if(n==0)return;var r=s.labs()[n-1],i=e.order();e.order(r.order()),r.order(i),s.sort()},s.moveLabDown=function(e,t){t&&t.stopImmediatePropagation();var n=s.labs.indexOf(e);if(n==s.labs().length-1)return;var r=s.labs()[n+1],i=e.order();e.order(r.order()),r.order(i),s.sort()},s.refresh=function(e,t){t.stopImmediatePropagation(),s.loadLabs()},s.toggleTaskMark=function(e,t){e.toggleTaskMark(t)}}}),define("main",["knockout","cookies","marks/discipline","marks/markstable","labs/labstable","urls","helpers"],function(e,t,n,r,i,s,o){return function(){function a(){u.loadDisciplines().done(function(){u.loadYears().done(function(){u.restoreLastDiscipline(),u.year.subscribe(function(){if(!u.labs_loading_complete)return;u.year()&&u.discipline()?u.loadGroups():u.marksTable.setParams(null,null)}),u.group.subscribe(function(){if(!u.groups_loading_complete)return;var e=u.group()?u.group().id:null;u.marksTable.setParams(e,u.discipline().id)}),u.discipline.subscribe(function(){u.labs_loading_complete=!1,u.marksTable.setParams(null,null),u.groups.removeAll(),u.labsTable.setParams(u.discipline().id),u.discipline()&&$.cookie(t.discipline_id,u.discipline().id,{expires:t.expires})}),u.restoreLastYear()})})}var u=this;u.marksTable=new r(u),u.labsTable=new i,u.labsTable.onLabsLoadingComplete=function(e,t){u.labs_loading_complete=!0,u.marksTable.setLabs(e,t),u.loadGroups()},u.updateCookies=function(e,n){$.cookie(t.keep_mark_table_open,!$("#marks-editor").hasClass("in"),t.expires)},u.labs_loading_complete=!0,u.restoreLastDiscipline=function(){var e=$.cookie(t.discipline_id);if(u.disciplines().length>0){u.labs_loading_complete=!1,u.discipline(u.disciplines()[0]);if(e)for(var n=0;n<u.disciplines().length;++n){var r=u.disciplines()[n];if(r.id==e){u.discipline(r);break}}u.labsTable.setParams(u.discipline().id)}},u.restoreLastYear=function(){var e=$.cookie(t.year),n=u.years().some(function(t){return t.year==e});n?u.year(e):u.years().length>0&&u.year(u.years()[0].year)},u.restoreLastGroup=function(){var e=$.cookie(t.group_id);u.groups().every(function(t){return e==t.id?(u.group(t),!1):!0})&&(u.groups().length?u.group(u.groups()[0]):u.group(null))},u.visibleStudent=function(t){return e.pureComputed(function(){return t.regularStudent()||u.labsTable.hasLabsForStudent(t)()})},u.taskPercentsComplete=function(t){return e.pureComputed(function(){var e=u.marksTable.students().length,n=0;for(var r in t.lab.marks)for(var i in t.lab.marks[r])if(parseInt(i)==t.id){var s=t.lab.marks[r][i];if(s.group==u.group().id){++n;break}}return n/e})},u._block=!1,u.block=function(){u._block=!0},u.unblock=function(){u._block=!1},u.check_block=function(e){return u._block?null:e()},u.years=e.observableArray(),u.year=e.observable(),u.groups=e.observableArray(),u.group=e.observable(),u.disciplines=e.observableArray(),u.discipline=e.observable(),u.years_loading_complete=!0,u.loadYears=function(){if(!u.years_loading_complete)return;return u.years_loading_complete=!1,u.years.length=0,$.get(s.url.years,{},u.years).done(function(e){u.years_loading_complete=!0})},u.groups_loading_complete=!0,u.loadGroups=function(e){if(!u.groups_loading_complete)return;u.groups_loading_complete=!1,u.groups.removeAll(),$.get(s.url.groups,{year:u.year()||0,discipline_id:u.discipline().id},u.groups).done(function(n){$.cookie(t.year,u.year(),{expires:t.expires}),u.groups.sort(function(e,t){return e.title==t.title?0:e.title<t.title?-1:1}),u.groups_loading_complete=!0,u.restoreLastGroup(),e&&e()})},u.loadDisciplines=function(){return u.disciplines.removeAll(),$.get(s.url.disciplines).done(function(e){for(var t=0;t<e.length;++t){var r=new n(e[t],u);u.disciplines.push(r)}}).fail(function(){o.showFail()})},u.addDiscipline=function(){var e=new n({id:"-1",title:" "},u);e.add(function(){location.reload()})},u.editDiscipline=function(){u.discipline().id&&u.discipline().edit()},u.toggleDiscipline=function(){u.discipline()&&u.discipline().toggle()},u.removeDiscipline=function(){u.discipline()&&u.discipline().remove(function(){u.disciplines.remove(u.discipline())})},u.activeItems=e.pureComputed(function(){return u.marksTable.is_active()+u.labsTable.is_active()}),u.hasData=e.pureComputed(function(){return u.marksTable.students().length>0||u.labsTable.labs().length>0}),u.loadingComplete=e.pureComputed(function(){return!u.marksTable.isStudentsLoading()&&!u.labsTable.labsLoading()}),u.containerMoved=!1,function(){var e=-1,t=!1,n=function(n){var r=n.clientX;t&&e!=-1&&Math.abs(e-r)>2&&(this.scrollLeft+=e-r,$.cookie("lastScroll",this.scrollLeft),u.containerMoved=!0,u.marksTable.markSelector.close()),e=r};u.marksTable.$markseditor.on({mousedown:function(e){if(e.which===1)return t=!0,!1},touchmove:n,mousemove:n},u.marksTable.selectors.scroll_container),$(document).mouseup(function(e){t&&(t=!1,setTimeout(function(){u.containerMoved=!1},60))})}(),a()}}),require(["config"],function(){define("pickmeup",{}),require(["main","knockout"],function(e,t){var n=new e;t.applyBindings(n)})}),define("marks",function(){});